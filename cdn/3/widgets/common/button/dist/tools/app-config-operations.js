System.register(["jimu-core","jimu-ui"],(function(e,t){var i={},o={};return{setters:[function(e){i.Immutable=e.Immutable,i.dataSourceUtils=e.dataSourceUtils,i.dynamicStyleUtils=e.dynamicStyleUtils,i.expressionUtils=e.expressionUtils},function(e){o.utils=e.utils}],execute:function(){e((()=>{var e={14321:e=>{"use strict";e.exports=o},79244:e=>{"use strict";e.exports=i}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="";var s={};return n.p=window.jimuConfig.baseUrl,(()=>{"use strict";n.r(s),n.d(s,{default:()=>i});var e=n(79244),t=n(14321);class i{constructor(){this.id="button-app-config-operation"}useDataSourceWillChange(t,i,o){var n,s,l,r,a;const u=t.widgets[this.widgetId],c=u.config,d=c.functionConfig,g=c.styleConfig;if(!(d&&g&&i&&o))return t;const f=u.useDataSources,y=u.useDataSources.filter((e=>e.dataSourceId!==i)).concat(e.dataSourceUtils.getUseDataSourceByDataSourceId(o));let m,p,S;if(e.dataSourceUtils.areDerivedFromSameMain(i,o))m=d.set("textExpression",e.expressionUtils.replaceDataSourceId(d.textExpression,i,o,this.widgetId,t)).set("toolTipExpression",e.expressionUtils.replaceDataSourceId(d.toolTipExpression,i,o,this.widgetId,t)).setIn(["linkParam","expression"],e.expressionUtils.replaceDataSourceId(null===(n=d.linkParam)||void 0===n?void 0:n.expression,i,o,this.widgetId,t));else{u.useDataSources.find((e=>e.dataSourceId===i))&&(m=d.without("textExpression").without("toolTipExpression").set("linkParam",null===(s=d.linkParam)||void 0===s?void 0:s.without("expression")))}if((null===(l=null==c?void 0:c.styleConfig)||void 0===l?void 0:l.useCustom)&&c.styleConfig.customStyle&&((null===(r=c.styleConfig.customStyle.regular)||void 0===r?void 0:r.enableDynamicStyle)||(null===(a=c.styleConfig.customStyle.hover)||void 0===a?void 0:a.enableDynamicStyle))){p=g,["regular","hover"].forEach((t=>{const i=e.dynamicStyleUtils.updateDynamicStyleWhenUseDataSourcesChange(this.id,(0,e.Immutable)(f),(0,e.Immutable)(y),(0,e.Immutable)(c.styleConfig.customStyle[t].dynamicStyleConfig));i?p=p.setIn(["customStyle",t,"dynamicStyleConfig"],i):(p=p.setIn(["customStyle",t,"enableDynamicStyle"],!1),p=p.setIn(["customStyle",t],p.customStyle[t].without("dynamicStyleConfig")))}))}return m&&(S=t.setIn(["widgets",this.widgetId,"config","functionConfig"],m)),p&&(S=S.setIn(["widgets",this.widgetId,"config","styleConfig"],p)),S||t}afterWidgetCopied(i,o,n,s,l){var r,a,u,c,d,g;if(!l)return s;let f=s;const y=o.widgets[i],m=null==y?void 0:y.config,p=m.functionConfig.linkParam,{linkParam:S,isChanged:v}=t.utils.mapLinkParam(l,p,y);v&&(f=f.setIn(["widgets",n,"config","functionConfig","linkParam"],S));const C=m.functionConfig.textExpression,x=e.expressionUtils.mapExpression(l,C,y);f=x.isChanged?f.setIn(["widgets",n,"config","functionConfig","textExpression"],x.expression):f;const I=m.functionConfig.toolTipExpression,h=e.expressionUtils.mapExpression(l,I,y);f=h.isChanged?f.setIn(["widgets",n,"config","functionConfig","toolTipExpression"],h.expression):f;const w=null===(u=null===(a=null===(r=m.styleConfig)||void 0===r?void 0:r.customStyle)||void 0===a?void 0:a.regular)||void 0===u?void 0:u.dynamicStyleConfig;if(w){const t=e.dynamicStyleUtils.getCopiedDynamicStyleConfig(l,y,w);f=f.setIn(["widgets",n,"config","styleConfig","customStyle","regular","dynamicStyleConfig"],t)}const U=null===(g=null===(d=null===(c=m.styleConfig)||void 0===c?void 0:c.customStyle)||void 0===d?void 0:d.hover)||void 0===g?void 0:g.dynamicStyleConfig;if(U){const t=e.dynamicStyleUtils.getCopiedDynamicStyleConfig(l,y,U);f=f.setIn(["widgets",n,"config","styleConfig","customStyle","hover","dynamicStyleConfig"],t)}return f}}})(),s})())}}}));