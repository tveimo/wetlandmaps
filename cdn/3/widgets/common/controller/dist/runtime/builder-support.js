/*! For license information please see builder-support.js.LICENSE.txt */
System.register(["jimu-core","jimu-for-builder","jimu-layouts/layout-runtime","jimu-ui","jimu-theme","jimu-layouts/layout-builder","jimu-core/react","jimu-ui/advanced/setting-components"],(function(e,t){var o={},a={},i={},n={},l={},r={},s={},d={};return Object.defineProperty(s,"__esModule",{value:!0}),{setters:[function(e){o.AppMode=e.AppMode,o.BaseVersionManager=e.BaseVersionManager,o.ErrorBoundary=e.ErrorBoundary,o.FixedPosition=e.FixedPosition,o.Immutable=e.Immutable,o.LayoutItemType=e.LayoutItemType,o.LayoutType=e.LayoutType,o.React=e.React,o.ReactRedux=e.ReactRedux,o.WidgetManager=e.WidgetManager,o.WidgetState=e.WidgetState,o.WidgetType=e.WidgetType,o.appActions=e.appActions,o.classNames=e.classNames,o.css=e.css,o.focusElementInKeyboardMode=e.focusElementInKeyboardMode,o.getAppStore=e.getAppStore,o.hooks=e.hooks,o.i18n=e.i18n,o.jsx=e.jsx,o.lodash=e.lodash,o.polished=e.polished},function(e){a.appConfigUtils=e.appConfigUtils,a.getAppConfigAction=e.getAppConfigAction},function(e){i.LayoutContext=e.LayoutContext,i.LayoutItemSizeModes=e.LayoutItemSizeModes,i.PageContext=e.PageContext,i.searchUtils=e.searchUtils,i.utils=e.utils},function(e){n.Button=e.Button,n.FloatingPanel=e.FloatingPanel,n.Icon=e.Icon,n.Loading=e.Loading,n.MobilePanel=e.MobilePanel,n.Modal=e.Modal,n.ModalBody=e.ModalBody,n.NavButtonGroup=e.NavButtonGroup,n.Pagination=e.Pagination,n.Popper=e.Popper,n.Tooltip=e.Tooltip,n.defaultMessages=e.defaultMessages,n.styleUtils=e.styleUtils},function(e){l.getBuilderThemeVariables=e.getBuilderThemeVariables,l.getTheme2=e.getTheme2,l.styled=e.styled,l.useTheme=e.useTheme},function(e){r.CanvasPane=e.CanvasPane,r.DropArea=e.DropArea,r.LayoutItemToolbar=e.LayoutItemToolbar,r.withRnd=e.withRnd},function(e){Object.keys(e).forEach((function(t){s[t]=e[t]}))},function(e){d.SortTree=e.SortTree}],execute:function(){e((()=>{var e={1888:e=>{"use strict";e.exports=l},4108:e=>{"use strict";e.exports=a},4651:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2 7a1 1 0 1 0 0 2 1 1 0 0 0 0-2m5 1a1 1 0 1 1 2 0 1 1 0 0 1-2 0m6 0a1 1 0 1 1 2 0 1 1 0 0 1-2 0" clip-rule="evenodd"></path></svg>'},4843:(e,t,o)=>{"use strict";o.d(t,{z:()=>m});var a=o(79244),i=o(19640),n=o(70687),l=o(14321),r=o(17087);const s=(e,t,o)=>a.css`
    position: ${e===t?"relative":"absolute"};
    left: ${(e-t)*(6*o+40)}px;
    transition: all ease 0.3s;
  `,d=e=>{const{lists:t=[],createItem:o,itemLength:i,isOpen:n,reference:d,advancedStyle:c,onClose:u,onMouseDown:p}=e,v=a.hooks.useCheckSmallBrowserSizeMode(),g=3*(v?4:5),[m,h]=a.React.useState(1),f=Math.ceil(t.length/g),y=new Array(f).fill(1).map(((e,t)=>t+1)),w=e=>{h(e)},b=a.hooks.useLatest(m);a.React.useEffect((()=>{b.current>f&&0!==f&&h(f)}),[b,f]);const I=((e,t,o)=>{const i=o?4:5,n=o?a.css`top: 50% !important; left: 50% !important; transform: translate(-50%, -50%) !important;`:"";return a.css`
    ${n}
    &.modal-dialog {
      width: fit-content;
      margin: 0;
      .modal-content {
        border-radius: 8px;
        .modal-body {
          padding: 0;
        }
      }
    }
    &.popper {
      border-radius: 4px;
    }
    .popup-more {
      padding: var(--sys-spacing-3);
      display: flex;
      position: relative;
      overflow: hidden;
      .popup-page {
        display: grid;
        max-width: ${e*i}px;
        grid-template-columns: repeat(${t>1||o?i:"auto-fit"}, ${e}px);
        grid-template-rows: repeat(${t>1||o?3:"auto-fit"}, 1fr);
        gap: var(--sys-spacing-2) 0;
        justify-content: center;
      }
    }
    .popup-pagination {
      padding: 0 var(--sys-spacing-3) var(--sys-spacing-2) var(--sys-spacing-3);
      text-align: center;
      .jimu-pagination {
        justify-content: center;
        .jimu-page-number {
          display: none;
        }
      }
      .page-indicator {
        width: 6px;
        height: 6px;
        padding: 0;
        border-radius: 3px;
        border: none;
        background-color: var(--sys-color-action-disabled);
        transition: width ease 0.3s;
        &+.page-indicator {
          margin-left: 8px;
        }
        &.page-current {
          background-color: var(--sys-color-action-selected);
        }
      }
    }
  `})(i,y.length,v),S=a.React.useRef(0),x=a.React.useRef(0),R=(0,a.jsx)(a.React.Fragment,null,(0,a.jsx)("div",{className:"popup-more",css:c,onTouchStart:e=>{1===e.touches.length&&(S.current=e.touches[0].clientX)},onTouchMove:e=>{1===e.touches.length&&(x.current=e.touches[0].clientX)},onTouchEnd:e=>{const t=x.current-S.current;t<-100&&h((e=>e<f?e+1:e)),t>100&&h((e=>e>1?e-1:e)),S.current=0,x.current=0},onMouseDown:p},y.map((e=>{const n=t.slice(g*(e-1),g*e);return(0,a.jsx)("div",{key:e,className:"popup-page",css:s(e,m,i),onFocus:()=>{h(e)}},n.map((e=>o(e,"popup-list-item",u))))}))),y.length>1&&(0,a.jsx)("div",{className:"popup-pagination"},v&&y.map((e=>(0,a.jsx)(l.Button,{key:e,tabIndex:-1,"aria-hidden":!0,className:(0,a.classNames)("page-indicator",{"page-current":m===e}),onClick:()=>{w(e)}}))),!v&&(0,a.jsx)(l.Pagination,{variant:"text",current:m,simple:!0,size:"sm",totalPage:y.length,onChangePage:w})));return v?(0,a.jsx)(l.Modal,{className:"popup-more-modal",css:I,isOpen:n,toggle:u},(0,a.jsx)(l.ModalBody,null,R)):(0,a.jsx)(l.Popper,{className:"popup-more-popper",css:I,open:n,reference:d,autoFocus:!0,trapFocus:!0,flipOptions:r.yH,shiftOptions:r.ZT,offsetOptions:r.XJ,toggle:u},R)};var c=o(50572),u=o(13166),p=o(4651),v=o.n(p),g=o(54657);const m=a.React.forwardRef(((e,t)=>{const{vertical:o,alignment:l,space:r,itemStyle:s,lists:p=[],createItem:m,itemLength:h,autoSize:f,advanced:y,className:w,onMouseDown:b}=e,I=((e,t,o,i=n.aL.Center)=>a.css`
    &.root {
      flex-direction: ${e?"column":"row"};
      width: 100%;
      height: 100%;
      ${e?`min-height: ${o}px;`:`min-width: ${o}px;`}
      max-height: 100%;
      max-width: 100%;
      display: flex;
      justify-content: ${"center"===i?"center":"flex-"+i};
      flex-wrap: nowrap;
      align-items: center;
      .popup-list-item {
        &:not(:first-of-type) {
          margin-top: ${e?t+"px":"unset"};
          margin-left: ${e?"unset":t+"px"};
        }
      }
    }
  `)(o,r,h,l),[S,x]=a.hooks.useForwardRef(t),R=(0,i.s)({rootRef:S,lists:p,itemLength:h,autoSize:f,vertical:o,space:r});let C=p,k=[],A=!1;R<p.length&&(C=p.slice(0,R-1),k=p.slice(R-1),A=!0);const[M,j]=a.React.useState(!1),z=a.React.useRef(null),L=a.React.useCallback((e=>{j((t=>{const o="boolean"==typeof e?e:!t;return o||(0,a.focusElementInKeyboardMode)(z.current),o}))}),[]);a.React.useEffect((()=>{0===k.length&&j(!1)}),[k.length]);const T=a.hooks.useTranslation(u.A),O=(0,g.useAdvancedStyle)(s.variant,y);return(0,a.jsx)("div",{className:(0,a.classNames)("root popup-list-root",w),css:I,ref:x,onMouseDown:b},C.map((e=>m(e,(0,a.classNames)("popup-list-item")))),A&&(0,a.jsx)(c.I6,{ref:z,className:"popup-more-card popup-list-item",label:T("moreWidgets"),icon:v(),showLabel:s.showLabel,showIndicator:s.showIndicator,showTooltip:s.showTooltip,labelGrowth:s.labelGrowth,avatar:s.avatar,active:M,onClick:()=>{L()}}),(0,a.jsx)(d,{lists:k,createItem:m,isOpen:M,itemLength:h,reference:z.current,advancedStyle:O,onClose:()=>{L(!1)},onMouseDown:b}))}))},6055:e=>{"use strict";e.exports=r},9567:(e,t,o)=>{"use strict";o.d(t,{F:()=>l,_:()=>n});var a=o(79244),i=o(50572);const n=(e,t)=>{const o=null==e?void 0:e.showLabel,a=null==e?void 0:e.labelGrowth,n=null==e?void 0:e.avatar.size,l=null==e?void 0:e.avatar.shape;return(0,i.Q$)(n,o,l)+t+a},l=e=>{var t,o;if(!e)return;return(null===(o=null===(t=(0,a.getAppStore)().getState().widgetsRuntimeInfo)||void 0===t?void 0:t[e])||void 0===o?void 0:o.isClassLoaded)?Promise.resolve(a.WidgetManager.getInstance().getWidgetClass(e)):a.WidgetManager.getInstance().loadWidgetClass(e)}},12279:(e,t,o)=>{"use strict";o.d(t,{i7:()=>f,GD:()=>s,FZ:()=>d.F});var a=o(79244),i=o(50572),n=o(14321),l=o(62838),r=o.n(l);const s=e=>{var t,o;const{markerEnabled:l,onMarkerClick:s,widgetid:d,showLabel:c,showIndicator:u,showTooltip:p,labelGrowth:v,avatar:g,onClick:m,active:h,editDraggable:f,className:y}=e,w=a.ReactRedux.useSelector((e=>{var t;return null===(t=e.appConfig.widgets)||void 0===t?void 0:t[d]})),b="string"==typeof w.icon?w.icon:w.icon.asMutable({deep:!0});return w?a.React.createElement(i.I6,{widgetid:d,className:`widget-avatar-card ${y}`,showLabel:c,showIndicator:u,showTooltip:p,labelGrowth:v,avatar:g,label:w.label,icon:b,autoFlip:null===(o=null===(t=null==w?void 0:w.manifest)||void 0===t?void 0:t.properties)||void 0===o?void 0:o.flipIcon,marker:l?r():"",active:h,editDraggable:f,onMarkerClick:s,onClick:m}):a.React.createElement(n.Loading,null)};o(42667);var d=o(9567),c=o(49859),u=o.n(c),p=o(1888),v=o(70687);const g=(0,p.styled)("div",{shouldForwardProp:e=>!["vertical","space","alignment"].includes(e)})((e=>`\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: ${e.alignment===v.aL.Start?"flex-start":e.alignment===v.aL.End?"flex-end":"center"};\n  flex-direction: ${e.vertical?"column":"row"};\n  .avatar-placeholder {\n    &:not(:first-of-type) {\n      margin-top: ${e.vertical?a.polished.rem(e.space):"unset"};\n      margin-left: ${e.vertical?"unset":a.polished.rem(e.space)};\n    }\n  }\n`)),m=(e=>{const t=[];for(;e>0;)t.push(e),e--;return t})(3),h=(0,a.Immutable)({type:"secondary",size:"lg",shape:"circle"}),f=e=>{const{vertical:t,space:o,size:n="lg",alignment:l=v.aL.Center}=e,r=a.React.useMemo((()=>h.set("size",n)),[n]);return a.React.createElement(g,{className:"list-placeholder",vertical:t,space:o,alignment:l},m.map(((e,t)=>a.React.createElement(i.I6,{key:t,disabled:!0,className:"avatar-placeholder",icon:u(),label:"",showTooltip:!1,avatar:r}))))}},13166:(e,t,o)=>{"use strict";o.d(t,{A:()=>a});const a={_widgetLabel:"Widget Controller",_action_openWidget_label:"Open widget",_action_toggleWidget_label:"Toggle widget",resizerTooltip:"Customize the window size by dragging and dropping.",moreWidgets:"More widgets"}},14321:e=>{"use strict";e.exports=n},17087:(e,t,o)=>{"use strict";o.d(t,{D7:()=>s,Gt:()=>i,XJ:()=>v,ZT:()=>p,aP:()=>c,bC:()=>n,iI:()=>l,kg:()=>r,up:()=>d,yH:()=>u});var a=o(79244);const i=5,n="controller",l={sm:24,default:32,lg:48},r={width:150,height:120},s={width:360,height:360},d={x:70,y:70},c={x:30,y:30},u=(a.FixedPosition.TopRight,{flipAlignment:!1}),p={boundary:document.body,rootBoundary:"document"},v=16},19640:(e,t,o)=>{"use strict";o.d(t,{k:()=>l,s:()=>r});var a=o(79244);const i=(e,t=!1,o=0,i=o,n)=>{var l,r;const s=t?"clientHeight":"clientWidth",[d,c]=a.React.useState(null!==(r=null===(l=e.current)||void 0===l?void 0:l[s])&&void 0!==r?r:0),u=n,p=a.hooks.useLatest((()=>{const t=e.current[s]||0;c(t)})),v=a.React.useMemo((()=>a.lodash.debounce((()=>{p.current()}),500,{leading:!0})),[p]);return a.React.useEffect((()=>{if(u)return;const t=e.current;t&&v();const o=new ResizeObserver(v);return o.observe(t),()=>{o.disconnect(),v.cancel()}}),[e,v,u]),Math.max(d+o,i)},n=(e,t,o)=>{let a=e,i=t;return i-a>o?i=e+o:i-a<o&&(a=0,i=a+o),[a,i]},l=e=>{var t;const{rootRef:o,lists:l,itemLength:r,autoSize:s,vertical:d,space:c,autoScrollEnd:u}=e,p=null!==(t=null==l?void 0:l.length)&&void 0!==t?t:0;let v,g=i(o,d,c,r,s);s?(v=p,g=r*v):v=Math.floor(g/r)>p?p:Math.floor(g/r);const m=g-r*v,[h,f]=a.React.useState(n(0,0,v)[0]),[y,w]=a.React.useState(n(0,0,v)[1]),b=a.hooks.useLatest(h),I=a.hooks.useLatest(y),[S,x]=a.React.useState(y-h>=p),R=0===h,C=y===p;a.React.useEffect((()=>{if(0===g)return;const[e,t]=n(I.current,b.current,v);f(e),w(t),x(t-e>=p)}),[v,g,I,b,p]);const k=a.hooks.useEventCallback(((e,t=!0)=>{const o=t?1:v;let a=0,i=0;e?(a=h-o,a<0?(a=0,i=a+v):i=y-o):(i=y+o,i>p?(i=p,a=i-v):a=h+o),f(a),w(i)})),A=a.hooks.usePrevious(p);return a.React.useEffect((()=>{if(u&&(p>0&&A>0)&&A<p){let e=0,t=0;t=p,e=t-v,e=Math.max(0,e),f(e),w(t)}}),[u,p,v,A]),{start:h,end:y,disablePrevious:R,disableNext:C,hideArrow:S,scroll:k,remainLength:m}},r=e=>{var t;const{rootRef:o,lists:a,itemLength:n,autoSize:l,vertical:r,space:s}=e,d=null!==(t=null==a?void 0:a.length)&&void 0!==t?t:0,c=i(o,r,s,n,l);let u;return u=l||Math.floor(c/n)>d?d:Math.floor(c/n),u}},20863:(e,t,o)=>{"use strict";o.d(t,{A:()=>R});var a=o(79244),i=o(17087),n=o(28482),l=o(14321),r=o(12279),s=o(41496),d=function(e,t){var o={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(o[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(o[a[i]]=e[a[i]])}return o};function c(e){const{widgetId:t,canCrossLayoutBoundary:o,className:i,layoutId:n,layoutItemId:c}=e,u=d(e,["widgetId","canCrossLayoutBoundary","className","layoutId","layoutItemId"]),p=a.hooks.useCancelablePromiseMaker(),[v,g]=a.React.useState(null),[m,h]=a.React.useState(""),[f,y]=a.React.useState("");a.React.useEffect((()=>{g(null),h("");p((0,r.FZ)(t)).then((e=>{g(e),h(t)}),(e=>{var t;y(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:e)}))}),[p,t]);const w=a.React.useCallback((()=>{var e,o;if(f)return;if(window.jimuConfig.isBuilder)return;(null===(o=null===(e=(0,a.getAppStore)().getState().widgetsRuntimeInfo)||void 0===e?void 0:e[t])||void 0===o?void 0:o.state)===a.WidgetState.Active||(0,a.getAppStore)().dispatch(a.appActions.activateWidget(t))}),[f,t]),b=a.ReactRedux.useSelector((e=>e.appRuntimeInfo.appMode===a.AppMode.Design)),I=a.ReactRedux.useSelector((e=>{var o,a,i;const n=e.appConfig.widgets[t];return null!==(i=null===(a=null===(o=null==n?void 0:n.manifest)||void 0===o?void 0:o.properties)||void 0===a?void 0:a.supportInlineEditing)&&void 0!==i&&i})),S=a.ReactRedux.useSelector((e=>{const o=e.widgetsRuntimeInfo[t];return I&&(null==o?void 0:o.isInlineEditing)})),x=a.ReactRedux.useSelector((e=>{var o;const i=e.appConfig.widgets[t];return(null===(o=null==i?void 0:i.manifest)||void 0===o?void 0:o.widgetType)!==a.WidgetType.Layout})),R=a.ReactRedux.useSelector((e=>{var o,a,i;const n=e.appConfig.widgets[t];return(null===(a=null===(o=null==n?void 0:n.manifest)||void 0===o?void 0:o.properties)||void 0===a?void 0:a.hasEmbeddedLayout)&&Object.keys(null!==(i=n.layouts)&&void 0!==i?i:{}).length>0})),C=b&&!S&&x&&!R,{viewOnly:k}=a.React.useContext(s.PageContext),A=a.React.useCallback((e=>{const{browserSizeMode:o,appConfig:{mainSizeMode:i}}=(0,a.getAppStore)().getState();!I||k||window.parent.isExpressBuilder&&o!==i||(e.stopPropagation(),(0,a.getAppStore)().dispatch(a.appActions.setWidgetIsInlineEditingState(t,!0)))}),[I,k,t]),M=(0,a.classNames)("widget-renderer w-100 h-100",i),j=(e=>a.React.useMemo((()=>a.css`
      overflow: ${e?"visible":"hidden"};
      position: relative;
      .widget-content {
        position: relative;
        height: 100%;
        width: 100%;
        z-index: 0;
      }
      .widget-mask {
        position: absolute;
        background: transparent;
        left: 0;
        right: 0;
        top: 0;
        bottom: 0;
        z-index: 1;
      }
  `),[e]))(o);return(0,a.jsx)("div",Object.assign({css:j,className:M,onMouseDownCapture:w,onDoubleClickCapture:A,"data-widgetid":m},u),(0,a.jsx)("div",{className:"widget-content p-1"},f,!f&&v&&(0,a.jsx)(a.ErrorBoundary,null,(0,a.jsx)(v,{widgetId:m,layoutId:n,layoutItemId:c})),!f&&!v&&(0,a.jsx)(l.Loading,null)),C&&(0,a.jsx)("div",{className:"widget-mask"}))}const u=(0,a.Immutable)({}),p=e=>{var t,o,i;const{rootVisible:r,containerMapId:s,onClose:d,widgets:p=u,layout:v,onClick:g}=e,m=null!==(t=Object.keys(p).find((e=>(0,n.V5)(p[e]))))&&void 0!==t?t:"",h=null===(i=null===(o=(0,a.getAppStore)().getState().appConfig.widgets)||void 0===o?void 0:o[m])||void 0===i?void 0:i.label;return a.React.createElement(l.MobilePanel,{className:(0,a.classNames)("mobile-widget-launcher",{"d-none":!m}),mapWidgetId:s,title:h,open:!!m&&r,keepMount:!0,onClick:e=>{g(e,m)},onClose:e=>{d(e,m)}},Object.entries(p).map((([e,t])=>{if(!(void 0!==t.state))return null;const o=(0,n.V5)(t),i=null==v?void 0:v.id,l=(0,n.pp)(v,e);return a.React.createElement(c,{key:e,widgetId:e,layoutId:i,layoutItemId:l,onClick:t=>{g(t,e)},className:(0,a.classNames)({"d-none":!o})})})))};var v=o(70687),g=o(53716);const m=()=>document.body.getBoundingClientRect(),h=(e,t,o,i,n)=>{const[l,r]=a.React.useState((()=>m())),[s,d]=a.React.useState([o]),c=a.React.useRef(0);a.React.useEffect((()=>{const e=()=>{const e=m();r(e)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const u=(e,t)=>e.right>=t.right||e.left<=t.left,p=(e,t)=>e.bottom>=t.bottom||e.top<=t.top,g=a.hooks.useEventCallback((t=>{if(c.current++,c.current>7)return console.warn(`Number of cycles: ${c.current}.You may have opened too many panels, and now there is not enough space for them to be placed without overstepping and blocking`),t;const a=((e,t)=>!(!e||!t)&&(u(e,t)||p(e,t)))(t,l);if(!a)return t;const{width:i,height:r}=t;let{left:s,top:d,right:m,bottom:h}=t;if(a){const t=u({left:s,top:d,right:m,bottom:h,width:i,height:r},l),a=p({left:s,top:d,right:m,bottom:h,width:i,height:r},l);t&&(s=e===v.t2.SideBySide?o.x:l.right-i),a||e!==v.t2.SideBySide||(d+=n),m=s+i,h=d+r}return g({left:s,top:d,right:m,bottom:h,width:i,height:r})}));return a.React.useEffect((()=>{const a=[];let l={width:0,height:0};Object.keys(t).forEach(((r,s)=>{const d=t[r],u=0!==s?a[s-1]:o;let{x:p,y:m}=u;if(e===v.t2.SideBySide){const{width:e}=l;p+=i>0?e:-e,p+=0!==s?i:0}else e===v.t2.Stack&&(p+=0!==s?i:0,m+=0!==s?n:0);const h={left:p,top:m,right:p+d.width,bottom:m+d.height,width:d.width,height:d.height},{left:f,top:y}=g(h);c.current>7?(p=u.x,m=u.y):(p=f,m=y),c.current=0,a.push({x:p,y:m}),l=d})),d(a)}),[e,o,i,n,l.width,l.height,g,t]),s},f=(0,a.Immutable)({}),y=e=>{const{rootVisible:t,mode:o,start:r,spaceX:s,spaceY:d,sizes:u,widgets:p=f,layout:v,autoFocus:m,onResizeStop:y,onClick:w,onClose:b}=e,I=a.ReactRedux.useSelector((e=>e.appConfig.widgets)),[S,x]=a.React.useState(u),R=a.React.useMemo((()=>((e,t)=>{let o=(0,a.Immutable)({});return Object.keys(e).forEach((e=>{o=o.set(e,t[e]||i.D7)})),o})(p,S)),[S,p]),[C,k]=a.React.useState(!1),A=h(o,R,r,s,d),M=a.ReactRedux.useSelector((e=>e.appRuntimeInfo.appMode===a.AppMode.Run)),j=(0,a.jsx)(g.Ku,{isRuntime:M,isResizing:C});return(0,a.jsx)(a.React.Fragment,null,Object.entries(p).map((([e,o],i)=>{var r;if(!(void 0!==o.state))return null;const s=(0,n.V5)(o),d=A[i];if(!d)return null;const u=R[e],p=null===(r=null==I?void 0:I[e])||void 0===r?void 0:r.label,g=null==v?void 0:v.id,h=(0,n.pp)(v,e);return(0,a.jsx)(l.FloatingPanel,{key:e,style:{maxWidth:"100vw",position:"fixed"},headerTitle:p,defaultPosition:d,defaultSize:u,className:(0,a.classNames)({"d-none":!s||!t},"multiple-widget-launcher"),showHeaderClose:!0,showHeaderCollapse:!0,activateOnlyForHeader:!0,autoFocus:s&&m,dragBounds:"body",resizeHandle:j,onClick:t=>{w(t,e)},onResize:t=>{((e,t)=>{x(S.set(e,t)),k(!0)})(e,t)},onResizeStop:t=>{((e,t)=>{null==y||y(e,t),k(!1)})(e,t)},onHeaderClose:t=>{b(t,e)}},(0,a.jsx)(c,{widgetId:e,layoutId:g,layoutItemId:h}))})))},w=(0,a.Immutable)({}),b=e=>{const{widgets:t=w,root:o,placement:r,sizes:s,layout:d,autoFocus:u,onResizeStop:p,onClick:v,onClose:m}=e,h=a.ReactRedux.useSelector((e=>e.appConfig.widgets)),[f,y]=a.React.useState(s),[b,I]=a.React.useState(!1),S=a.ReactRedux.useSelector((e=>e.appRuntimeInfo.appMode===a.AppMode.Run)),x=(0,a.jsx)(g.Ku,{isRuntime:S,isResizing:b});return(0,a.jsx)(a.React.Fragment,null,Object.entries(t).map((([e,t])=>{var s,w;if(!(void 0!==t.state))return null;const b=t.state!==a.WidgetState.Closed,S=null!==(s=f[e])&&void 0!==s?s:i.D7,R=null===(w=null==h?void 0:h[e])||void 0===w?void 0:w.label;let C=(0,g.Ht)(e);C&&C.offsetParent||(C=(null==o?void 0:o.querySelector(".popup-more-card"))||(null==o?void 0:o.querySelector(".avatar-card")));const k=null==d?void 0:d.id,A=(0,n.pp)(d,e);return(0,a.jsx)(l.FloatingPanel,{key:e,style:{maxWidth:"100vw"},flipOptions:i.yH,shiftOptions:i.ZT,offsetOptions:i.XJ,className:(0,a.classNames)({"d-none":!b},"single-widget-launcher"),headerTitle:R,activateOnlyForHeader:!0,minSize:i.kg,dragBounds:"body",defaultSize:S,resizeHandle:x,onResize:t=>{var o,a;o=e,a=t,y((e=>e.set(o,a))),I(!0)},onResizeStop:t=>{var o,a;o=e,a=t,null==p||p(o,a),I(!1)},onHeaderClose:t=>{m(t,e)},showHeaderCollapse:!0,open:!0,autoFocus:b&&u,reference:C,onClick:t=>{v(t,e)},placement:r},(0,a.jsx)(c,{widgetId:e,layoutId:k,layoutItemId:A}))})))},I=(0,a.Immutable)({}),S=e=>{const{widgets:t=I,root:o,placement:r,layout:s,onClick:d,onClose:u}=e;return(0,a.jsx)(a.React.Fragment,null,Object.entries(t).map((([e,t])=>{if(!(void 0!==t.state))return null;const p=t.state!==a.WidgetState.Closed;let v=(0,g.Ht)(e);v&&v.offsetParent||(v=(null==o?void 0:o.querySelector(".popup-more-card"))||(null==o?void 0:o.querySelector(".avatar-card")));const m=null==s?void 0:s.id,h=(0,n.pp)(s,e);return(0,a.jsx)(l.Popper,{key:e,autoUpdate:!0,css:a.css`
    border-radius: 0;
    max-width: 100vw;
    .widget-content {
      padding: 0 !important;
    }
  `,flipOptions:i.yH,shiftOptions:i.ZT,offsetOptions:i.XJ,className:(0,a.classNames)({"d-none":!p},"off-panel-widget-launcher"),open:!0,autoFocus:p,reference:v,toggle:(t,o)=>{"escape"===o&&u(t,e)},onClick:t=>{d(t,e)},placement:r},(0,a.jsx)(c,{widgetId:e,layoutId:m,layoutItemId:h}))})))},x=e=>a.ReactRedux.useSelector((t=>{var o,a,i,n;const l=t.appConfig,r=t.browserSizeMode,d=l.widgets[e].parent;let c=null!==(o=d[r])&&void 0!==o?o:[];if(0===c.length){c=null!==(a=d[l.mainSizeMode])&&void 0!==a?a:[]}const u=null===(i=c[0])||void 0===i?void 0:i.layoutId,p=s.searchUtils.getWidgetIdThatUseTheLayoutId(l,u),v=l.widgets[p];return"arcgis-map"===(null===(n=null==v?void 0:v.manifest)||void 0===n?void 0:n.name)?v.id:""}));function R(e){var t,o,l,r,d,c,u,v,m,h;const{id:f,config:w,version:I,rootRef:R,autoFocus:C=!0,onResizeStop:k}=e,{viewOnly:A}=a.React.useContext(s.PageContext),M=a.hooks.useCheckSmallBrowserSizeMode(),j=null===(t=w.behavior)||void 0===t?void 0:t.onlyOpenOne,z=null!==(l=null===(o=null==w?void 0:w.behavior)||void 0===o?void 0:o.arrangement)&&void 0!==l?l:"floating",L=j&&"floating"===z,T=!j&&"floating"===z,O=(0,n.af)(f,i.bC),E=a.React.useCallback(((e,t)=>{var o;e.stopPropagation();const i=new CustomEvent("click");i.composedPath=()=>e.nativeEvent.composedPath(),window.dispatchEvent(i);const l=(0,a.getAppStore)().getState(),r=l.appRuntimeInfo.appMode===a.AppMode.Express,s=l.browserSizeMode!==l.appConfig.mainSizeMode;if(A||r&&s)return;const d=null==O?void 0:O.id,c=(0,n.pp)(O,t),u=null===(o=(0,a.getAppStore)().getState().appRuntimeInfo)||void 0===o?void 0:o.selection;u&&u.layoutId===d&&u.layoutItemId===c||(0,a.getAppStore)().dispatch(a.appActions.selectionChanged({layoutId:d,layoutItemId:c}))}),[O,A]),P=a.React.useCallback(((e,t)=>{if(!t)return;null==e||e.stopPropagation(),null==e||e.preventDefault(),(0,a.getAppStore)().dispatch(a.appActions.closeWidget(t));const o=(0,g.z_)(t)||(0,g.Sr)(f);(0,a.focusElementInKeyboardMode)(o),(0,a.getAppStore)().dispatch(a.appActions.selectionChanged(null))}),[f]),$=x(f),N=(null===(r=w.behavior)||void 0===r?void 0:r.vertical)?"right-start":"bottom-start",B=null===(d=w.behavior)||void 0===d?void 0:d.displayType,W=null===(v=null===(u=null===(c=(0,a.getAppStore)())||void 0===c?void 0:c.getState())||void 0===u?void 0:u.appContext)||void 0===v?void 0:v.isRTL,D=a.React.useMemo((()=>W?Object.assign(Object.assign({},i.up),{x:document.body.clientWidth-i.D7.width-i.up.x}):i.up),[W]),F=a.React.useMemo((()=>W?Object.assign(Object.assign({},i.aP),{x:-i.aP.x}):i.aP),[W]),H=null===(m=w.behavior)||void 0===m?void 0:m.size,G=(0,n.PG)(f,i.bC),V=a.hooks.useLatest(G),U=Object.keys(G),_=a.ReactRedux.useSelector((e=>{var t,o;const a=e.appRuntimeInfo.selection;return null===(o=null===(t=e.appConfig.layouts[null==a?void 0:a.layoutId])||void 0===t?void 0:t.content)||void 0===o?void 0:o[null==a?void 0:a.layoutItemId].widgetId}));a.hooks.useUpdateEffect((()=>{const e=Object.keys(V.current),t=e.filter((e=>(0,n.V5)(V.current[e])));e.includes(_)&&!t.includes(_)&&(0,g.xu)(f,_,t,w.behavior.onlyOpenOne)}),[w.behavior.onlyOpenOne,f,_,V]);const K=a.React.useCallback((()=>{const e=V.current,t=Object.keys(e).filter((t=>(0,n.V5)(e[t])));(0,a.getAppStore)().dispatch(a.appActions.closeWidgets(t))}),[V]);a.hooks.useUpdateEffect((()=>{(0,a.getAppStore)().dispatch(a.appActions.resetWidgetsState(U))}),[I]);const q=a.ReactRedux.useSelector((e=>e.appRuntimeInfo.currentPageId));a.hooks.useUpdateEffect((()=>{K()}),[q]);const X=(0,g.cq)(R.current),J=a.ReactRedux.useSelector((e=>e.appContext.isInBuilder)),Y=null===(h=w.behavior)||void 0===h?void 0:h.openStarts;a.React.useEffect((()=>{X?!J&&(null==Y?void 0:Y.length)>0&&(0,a.getAppStore)().dispatch(a.appActions.openWidgets(Y)):K()}),[K,J,Y,X]);const Q=a.ReactRedux.useSelector((e=>{const t=e.appConfig.widgets;return U.filter((e=>t[e].offPanel)).join(",")}),a.ReactRedux.shallowEqual),Z=U.filter((e=>!Q.split(",").includes(e))).join(","),ee=a.React.useMemo((()=>G.without.apply(G,Z.split(","))),[Z,G]),te=a.React.useMemo((()=>G.without.apply(G,Q.split(","))),[Q,G]);return(0,a.jsx)(a.React.Fragment,null,M&&(0,a.jsx)(p,{containerMapId:$,layout:O,widgets:G,rootVisible:X,onClick:E,onClose:P}),!M&&L&&(0,a.jsx)(b,{sizes:H,root:R.current,placement:N,widgets:te,layout:O,autoFocus:C,onResizeStop:k,onClick:E,onClose:P}),!M&&T&&(0,a.jsx)(y,{sizes:H,rootVisible:X,mode:B,start:D,spaceX:F.x,spaceY:F.y,widgets:te,layout:O,autoFocus:C,onResizeStop:k,onClick:E,onClose:P}),!M&&(0,a.jsx)(S,{root:R.current,placement:N,widgets:ee,layout:O,onClick:E,onClose:P}))}},26189:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 10"><path fill="#B6B6B6" d="M10 2.778V0L0 10h2.778zM10 5.607 5.607 10H10z"></path></svg>'},28482:(e,t,o)=>{"use strict";o.d(t,{H9:()=>v,PG:()=>l,V5:()=>p,af:()=>r,lL:()=>s,ne:()=>d,pp:()=>u});var a=o(79244),i=o(41496),n=o(17087);const l=(e,t)=>{const o=a.ReactRedux.useSelector((e=>e.widgetsRuntimeInfo)),i=r(e,t),n=c(i);return a.React.useMemo((()=>{const e={};return n.forEach((t=>{var i;const n=null!==(i=null==o?void 0:o[t])&&void 0!==i?i:{isClassLoaded:!1};e[t]=(0,a.Immutable)(n)})),(0,a.Immutable)(e)}),[n,o])},r=(e,t)=>a.ReactRedux.useSelector((o=>{var a,n,l,r;const s=null===(l=null===(n=null===(a=o.appConfig.widgets)||void 0===a?void 0:a[e])||void 0===n?void 0:n.layouts)||void 0===l?void 0:l[t],d=o.browserSizeMode,c=o.appConfig.mainSizeMode,u=i.searchUtils.findLayoutId(s,d,c);return null===(r=o.appConfig.layouts)||void 0===r?void 0:r[u]})),s=(e,t)=>{var o,n,l,r;const s=(0,a.getAppStore)().getState().appConfig,d=(0,a.getAppStore)().getState().browserSizeMode,c=null===(l=null===(n=null===(o=s.widgets)||void 0===o?void 0:o[e])||void 0===n?void 0:n.layouts)||void 0===l?void 0:l[t],u=i.searchUtils.findLayoutId(c,d,s.mainSizeMode);return null===(r=s.layouts)||void 0===r?void 0:r[u]},d=e=>{var t,o,a;let i=(null!==(a=null===(o=null===(t=null==e?void 0:e.order)||void 0===t?void 0:t.asMutable)||void 0===o?void 0:o.call(t))&&void 0!==a?a:[]).map((t=>{var o;return null===(o=e.content)||void 0===o?void 0:o[t]}));return i=i.filter((e=>e&&e.id&&e.widgetId&&!e.isPending)),i.map((e=>e.id))},c=e=>d(e).map((t=>{var o,a;return null===(a=null===(o=e.content)||void 0===o?void 0:o[t])||void 0===a?void 0:a.widgetId})),u=(e,t)=>{if(null!=(null==e?void 0:e.content)&&t)return Object.keys(e.content).find((o=>e.content[o].widgetId===t))},p=e=>[a.WidgetState.Opened,a.WidgetState.Active].includes(e.state),v=e=>{const t=l(e,n.bC),o=Object.keys(t);return a.ReactRedux.useSelector((t=>{var a,i,n;const l=t.appRuntimeInfo.selection,r=null===(n=null===(i=null===(a=t.appConfig.layouts[null==l?void 0:l.layoutId])||void 0===a?void 0:a.content)||void 0===i?void 0:i[null==l?void 0:l.layoutItemId])||void 0===n?void 0:n.widgetId;return e===r||o.includes(r)}))}},41496:e=>{"use strict";e.exports=i},42667:(e,t,o)=>{"use strict";o.d(t,{Q:()=>d});var a=o(79244),i=o(14321),n=o(19640),l=o(70687),r=o(28482);const s=[],d=a.React.forwardRef(((e,t)=>{const{controllerId:o,className:d,lists:c=s,createItem:u,vertical:p,itemLength:v,space:g,alignment:m=l.aL.Center,autoScrollEnd:h,autoSize:f,onMouseDown:y}=e,w=a.hooks.useTranslation(i.defaultMessages),[b,I]=a.hooks.useForwardRef(t),{start:S,end:x,disablePrevious:R,disableNext:C,hideArrow:k,scroll:A,remainLength:M}=(0,n.k)({rootRef:b,lists:c,itemLength:v,autoSize:f,vertical:p,space:g,autoScrollEnd:h}),j=c.slice(S,x),z=(({vertical:e,space:t,itemLength:o,autoSize:i,hideArrow:n,alignment:r,remainLength:s})=>a.css`
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    button.previous, button.next {
      flex-shrink: 0;
      display: ${n?"none":"block"};
    }
    ${r!==l.aL.Start||i||e?"":`button.next { transform: translateX(${-s}px); }`}
    ${r===l.aL.Start&&!i&&e?`button.next { transform: translateY(${-s}px); }`:""}
    ${r!==l.aL.End||i||e?"":`button.previous { transform: translateX(${s}px); }`}
    ${r===l.aL.End&&!i&&e?`button.previous { transform: translateY(${s}px); }`:""}
    .root {
      flex-direction: ${e?"column":"row"};
      width: 100%;
      height: 100%;
      ${e?`min-height: ${o}px;`:`min-width: ${o}px;`} 
      max-height: ${i?"100%":"calc(100% - 20px)"};
      max-width: ${i?"100%":"calc(100% - 20px)"};
      display: flex;
      justify-content: ${r===l.aL.Start?"flex-start":r===l.aL.End?"flex-end":"center"};
      flex-wrap: nowrap;
      align-items: center;
      .scroll-list-item {
        &:not(:first-of-type) {
          margin-top: ${e?t+"px":"unset"};
          margin-left: ${e?"unset":t+"px"};
        }
      }
    }
`)({vertical:p,space:g,itemLength:v,autoSize:f,hideArrow:k,alignment:m,remainLength:M}),L=(0,r.H9)(o);a.React.useEffect((()=>{L&&((0,a.getAppStore)().dispatch(a.appActions.widgetStatePropChange(o,"hideArrow",k)),(0,a.getAppStore)().dispatch(a.appActions.widgetStatePropChange(o,"disablePrevious",R)),(0,a.getAppStore)().dispatch(a.appActions.widgetStatePropChange(o,"disableNext",C)),(0,a.getAppStore)().dispatch(a.appActions.widgetToolbarStateChange(o,["controller-previous","controller-next"])))}),[o,C,R,k,L]),a.React.useEffect((()=>{L&&(0,a.getAppStore)().dispatch(a.appActions.widgetStatePropChange(o,"onArrowClick",A))}),[o,L,A]);return(0,a.jsx)(i.NavButtonGroup,{css:z,variant:"text",tag:"div",vertical:p,onChange:e=>{A(e,!0)},disablePrevious:R,disableNext:C,previousAriaLabel:w("previous"),nextAriaLabel:w("next"),className:(0,a.classNames)("scroll-list",d)},(0,a.jsx)("div",{className:"root scroll-list-root",ref:I,onMouseDown:y},c.map((e=>{const t=!j.includes(e);return u(e,(0,a.classNames)("scroll-list-item",{"d-none":t}))}))))}))},49859:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" d="M4 4h2v1H4zM8 4h2v1H8zM14 4h-2v1h2zM15 4h1v2h-1zM16 8h-1v2h1zM4 14h1v2H4zM5 6H4v2h1zM4 10h1v2H4zM16 12h-1v2h1zM16 15v1h-2v-1zM12 15h-2v1h2zM6 15h2v1H6z"></path><path fill="#000" fill-rule="evenodd" d="M18 0a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm0 1H2a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1" clip-rule="evenodd"></path></svg>'},50572:(e,t,o)=>{"use strict";o.d(t,{I6:()=>d,Q$:()=>l});var a=o(79244),i=o(14321),n=o(17087);const l=(e,t,o)=>{let a=n.iI[e];t&&(a+=21);return a+=2*r(e,o),a},r=(e,t)=>"circle"===t?"sm"===e?4:"default"===e?2:"lg"===e?0:void 0:6,s={none:"0",sm:"0",default:"var(--sys-shape-1)",lg:"var(--sys-shape-2)"},d=a.React.forwardRef(((e,t)=>{var o;const{label:n,className:d,showLabel:c,showIndicator:u=!0,showTooltip:p=!0,labelGrowth:v=0,icon:g,marker:m,onClick:h,onMarkerClick:f,avatar:y,autoFlip:w,active:b,editDraggable:I,disabled:S,widgetid:x}=e,R=y.type||"primary",C=y.size||"default",k=y.shape||"circle",A=((e,t,o,i,n)=>a.React.useMemo((()=>{const s=l(e,t,i),d=s+n,c=r(e,i);return a.css`
      display: flex;
      align-items:center;
      flex-direction: column;
      justify-content: ${t?"space-around":"center"};
      width: ${a.polished.rem(d)} !important;
      height: ${a.polished.rem(s)};
      .tool-drag-handler {
        cursor: auto;
      }
      .avatar {
        padding: ${c}px;
        position: relative;
        text-align: center;
        &:hover .marker {
          visibility: visible;
        }
        .avatar-button.disabled {
          color: var(--sys-color-action-disabled-text);
          background-color: var(--sys-color-action-disabled);
          border: 1px solid var(--sys-color-divider-secondary);
        }
        .marker {
          position: absolute;
          right: 0;
          top: 0;
          padding: 0;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          .icon-btn-sizer {
            min-width: .625rem;
            min-height: .625rem;
          }
          visibility: hidden;
        }
      }
      ${o?".avatar.active {\n        .avatar-button, .marker {\n          transform: translateY(-7px);\n        }\n        ::after {\n          content: '';\n          position: absolute;\n          bottom: 0;\n          left: 50%;\n          transform: translateX(-50%);\n          border: 1px solid var(--ref-palette-white);\n          border-radius: 3px;\n          width: 6px;\n          height: 3px;\n          background-color: var(--sys-color-primary-main);\n          box-sizing: content-box;\n        }\n      }":""}
      .avatar-label {
        text-align: center;
        width: 100%;
        min-height: ${a.polished.rem(21)};
        cursor: default;
      }
    `}),[e,t,i,n,o]))(C,c,u,k,v),M=s[C],j=(0,a.jsx)(i.Button,{"data-widgetid":x,"aria-label":n,"aria-expanded":b,"aria-haspopup":"dialog",icon:!0,active:b,className:(0,a.classNames)("avatar-button",{disabled:S}),type:R,size:C,style:{borderRadius:"circle"===k?"50%":M},onClick:h},(0,a.jsx)(i.Icon,{color:"string"!=typeof g&&(null===(o=g.properties)||void 0===o?void 0:o.color),icon:"string"!=typeof g?g.svg:g,autoFlip:w}));return(0,a.jsx)("div",{ref:t,"data-widgetid":x,className:(0,a.classNames)("avatar-card",{active:b},d),css:A},(0,a.jsx)("div",{className:(0,a.classNames)({"no-drag-action":!I,active:b},"avatar tool-drag-handler")},p?(0,a.jsx)(i.Tooltip,{title:n,style:{pointerEvents:"none"}},j):j,m&&(0,a.jsx)(i.Button,{className:"marker",size:"sm",icon:!0,onClick:f},(0,a.jsx)(i.Icon,{size:8,icon:m}))),c&&(0,a.jsx)("div",{className:(0,a.classNames)("avatar-label text-truncate",{active:b})},n))}))},53716:(e,t,o)=>{"use strict";o.d(t,{Ht:()=>s,Ku:()=>u,Sr:()=>c,cq:()=>g,xu:()=>v,z_:()=>d});var a=o(79244),i=o(14321),n=o(28482),l=o(17087),r=o(13166);const s=e=>document.querySelector(`.widget-controller .avatar-card[data-widgetid='${e}']`),d=e=>document.querySelector(`.widget-controller .avatar-card[data-widgetid='${e}'] button`),c=e=>document.querySelector(`[data-widgetid='${e}'] .popup-more-card button`),u=e=>{const{isRuntime:t,isResizing:n}=e,l=a.hooks.useTranslation(r.A),s=o(t?26189:54044);return a.React.useMemo((()=>{const e=(0,a.jsx)("div",{className:"resize-handle d-flex p-1"},(0,a.jsx)(i.Icon,{icon:s,size:t?10:16,currentColor:!1}));return n||t?e:(0,a.jsx)(i.Tooltip,{title:l("resizerTooltip")},e)}),[n,t,s,l])},p=(e,t)=>{const o=(0,n.lL)(t,l.bC),i=Object.keys(o.content).find((t=>o.content[t].widgetId===e));(0,a.getAppStore)().dispatch(a.appActions.selectionChanged({layoutId:o.id,layoutItemId:i}))},v=(e,t,o,i,n=!1)=>{i?((0,a.getAppStore)().dispatch(a.appActions.closeWidgets(o)),o.includes(t)||((0,a.getAppStore)().dispatch(a.appActions.openWidget(t)),n&&p(t,e))):o.includes(t)?(0,a.getAppStore)().dispatch(a.appActions.closeWidget(t)):((0,a.getAppStore)().dispatch(a.appActions.openWidget(t)),n&&p(t,e))},g=e=>{const[t,o]=a.React.useState(!0);return a.React.useEffect((()=>{let t;return e?(t=new IntersectionObserver((e=>{const t=e[0];if(!t)return;const a=t.target.checkVisibility();o(a)})),t.observe(e)):o(!1),()=>{t&&t.disconnect()}}),[e]),t}},54044:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M12 0h4v16H0v-4h12z"></path><path fill="#FFF" d="M13 1h2v14H1v-2h12z"></path></svg>'},54657:(e,t,o)=>{"use strict";o.d(t,{useAdvancedStyle:()=>w});var a=o(79244),i=o(9567),n=o(70687),l=o(42667),r=o(12279),s=o(17087),d=o(28482),c=o(20863),u=o(53716),p=o(4843);const v=e=>{var t,o,v,g,m,h,f,y;const{id:w,config:b,version:I,autoSize:S}=e,x=null===(t=b.behavior)||void 0===t?void 0:t.onlyOpenOne,R=null===(o=b.behavior)||void 0===o?void 0:o.vertical,C=b.behavior.overflownStyle||n.AH.Arrows,k=null===(v=null==b?void 0:b.appearance)||void 0===v?void 0:v.card,A=(0,i._)(k,null===(g=null==b?void 0:b.appearance)||void 0===g?void 0:g.space),M=a.hooks.useCheckSmallBrowserSizeMode(),j=a.React.useRef(null),z=(0,d.PG)(w,s.bC),L=Object.keys(z),T=L.filter((e=>(0,d.V5)(z[e]))),O=a.React.useCallback((e=>{var t;const o=null===(t=e.currentTarget.dataset)||void 0===t?void 0:t.widgetid;if(!o)return;const a=!!M||x;T.includes(o)||e.stopPropagation(),(0,u.xu)(w,o,T,a,!0)}),[M,x,T,w]),[E,P]=a.React.useState(!1),$=a.React.useCallback(((e,t,o)=>{const i=T.includes(e);return a.React.createElement(r.GD,{key:e,className:`${t} layout-item`,widgetid:e,markerEnabled:!1,active:i,showLabel:k.showLabel,showIndicator:k.showIndicator,showTooltip:k.showTooltip,labelGrowth:k.labelGrowth,avatar:k.avatar,variant:k.variant,onClick:t=>{P(!0),(0,a.getAppStore)().dispatch(a.appActions.widgetStatePropChange(e,"autoFocus",!0)),null==o||o(t),O(t)}})}),[k,O,T]);return a.React.createElement("div",{className:"controller-runtime w-100 h-100"},a.React.createElement(c.A,{id:w,config:b,version:I,rootRef:j,autoFocus:E}),C===n.AH.PopupWindow&&a.React.createElement(p.z,{ref:j,className:"runtime--popup-list",vertical:R,itemLength:A,space:null===(m=b.appearance)||void 0===m?void 0:m.space,alignment:null===(h=b.behavior)||void 0===h?void 0:h.alignment,autoSize:S,lists:L,createItem:$,itemStyle:k,advanced:b.appearance.advanced}),C===n.AH.Arrows&&a.React.createElement(l.Q,{ref:j,controllerId:w,className:"runtime--scroll-list",vertical:R,itemLength:A,space:null===(f=b.appearance)||void 0===f?void 0:f.space,alignment:null===(y=b.behavior)||void 0===y?void 0:y.alignment,autoSize:S,lists:L,createItem:$}))};var g=o(14321);const m={behavior:{onlyOpenOne:!0,openStarts:[],displayType:"STACK",vertical:!1,size:{}},appearance:{space:0,advanced:!1,card:{showLabel:!1,labelGrowth:10,showTooltip:!0,showIndicator:!1,avatar:{type:"primary",size:"default",shape:"circle"}}}};class h extends a.BaseVersionManager{constructor(){super(...arguments),this.versions=[{version:"1.0.0",description:"Version manager for release 1.0.0",upgrader:e=>{if(!e)return m;if(e.behavior&&e.appearance)return e;{let o=e;return e.behavior||(o=o.setIn(["behavior","openStarts"],[]),o=o.setIn(["behavior","onlyOpenOne"],e.onlyOpenOne),o=o.setIn(["behavior","displayType"],e.displayType),o=o.setIn(["behavior","vertical"],e.vertical),o=o.setIn(["behavior","size"],e.size),o=o.without(["onlyOpenOne","displayType","size"])),e.appearance||(o=o.setIn(["appearance","advanced"],!1),e.vertical?o=o.setIn(["appearance","space"],e.space):(o=o.setIn(["appearance","space"],0),o=o.setIn(["appearance","card","labelGrowth"],e.space)),o=o.setIn(["appearance","card","showLabel"],e.showLabel),o=o.setIn(["appearance","card","avatar","size"],"SMALL"===(t=e.iconSize)?"sm":"MEDIUM"===t?"default":"LARGE"===t?"lg":t),o=o.setIn(["appearance","card","avatar","shape"],e.iconStyle),o=o.setIn(["appearance","card","avatar","type"],"primary"),o=o.without(["space","showLabel","iconSize","iconStyle","vertical"])),o}var t}},{version:"1.1.0",description:"Version manager for release 1.1.0",upgrader:e=>{var t,o;if(!e)return m;let a=null===(t=null==e?void 0:e.appearance)||void 0===t?void 0:t.card;const i=null==a?void 0:a.variants,n=null===(o=null==a?void 0:a.avatar)||void 0===o?void 0:o.type;let l=e;if(i){const e=((e,t="primary")=>null==e?void 0:e[t])(i,n);a=null==a?void 0:a.set("variant",e).without("variants"),l=l.setIn(["appearance","card"],a)}return l}},{version:"1.6.0",description:"Version manager for release 1.6.0",upgrader:e=>{var t;if(!e)return m;let o=null===(t=null==e?void 0:e.appearance)||void 0===t?void 0:t.card,a=e;return o&&(o=o.set("showTooltip",!0),a=a.setIn(["appearance","card"],o)),a}},{version:"1.14.0",description:"Version manager for release 1.14.0",upgrader:e=>{var t;if(!e)return m;let o=null===(t=null==e?void 0:e.appearance)||void 0===t?void 0:t.card,a=e;return o&&(o=o.set("showIndicator",!1),a=a.setIn(["appearance","card"],o)),a}}]}}const f=new h,y=(e,t)=>{const{bg:o,iconColor:i,boxShadow:n,color:l,italic:r,bold:s,underline:d,strike:c}=e||{},u=g.styleUtils.toCSSTextUnderLine({underline:d,strike:c});let p=a.css``;return"active"===t&&(p=a.css`::after {
      background-color: ${o};
    }`),a.css`
    >.avatar {
      >.avatar-button {
        ${o?a.css`background-color: ${o}; border-color: ${o};`:""}
        ${i?a.css`color: ${i};`:""}
        ${(null==n?void 0:n.color)?a.css`box-shadow: ${g.styleUtils.toCSSBoxshadow(n)};`:""}
      }
      ${p}
    }
    >.avatar-label {
      ${l?a.css`color: ${l};`:""}
      ${r?a.css`font-style: italic;`:""}
      ${s?a.css`font-weight: bold;`:""}
      ${d||c?a.css`text-decoration: ${u};`:""}
    }
  `},w=(e,t)=>{const o=null==e?void 0:e.default,i=null==e?void 0:e.active,n=o&&i?o.merge(i):i,l=null==e?void 0:e.hover,r=o&&l?o.merge(l):l;return a.React.useMemo((()=>{const e=t&&o?y(o,"regular"):"",i=y({bg:"var(--sys-color-primary-dark)"},"active"),l=t&&n?y(n,"active"):"",s=t&&r?y(r,"hover"):"";return a.css`
      .avatar-card {
        ${e}
        ${a.css`&.active:not(.disabled) { ${i} }`}
        ${l?a.css`&.active:not(.disabled) { ${l} }`:""}
        ${s?a.css`&:hover { ${s} }`:""}
      }
    `}),[t,o,n,r])},b=e=>{var t,o,i,n;const{builderSupportModules:l,id:r,config:d,onInitResizeHandler:c,onInitDragHandler:u,autoWidth:p,autoHeight:g}=e,m=null===(t=d.behavior)||void 0===t?void 0:t.onlyOpenOne,h=null===(o=d.behavior)||void 0===o?void 0:o.displayType,f=null===(i=null==d?void 0:d.behavior)||void 0===i?void 0:i.vertical,y=null==d?void 0:d.appearance.advanced,b=null===(n=null==d?void 0:d.appearance)||void 0===n?void 0:n.card.variant,I=f?g:p,S=a.ReactRedux.useSelector((e=>e.appContext.isInBuilder)),x=a.ReactRedux.useSelector((e=>e.appRuntimeInfo.appMode));a.React.useEffect((()=>{null==c||c(null,null,(()=>{A((e=>e+1))}))}),[c]),a.React.useEffect((()=>{null==u||u(null,null,(()=>{A((e=>e+1))}))}),[u]);const R=S&&x!==a.AppMode.Run,C=R&&l.widgetModules.Builder,[k,A]=a.React.useState(0);a.hooks.useUpdateEffect((()=>{A((e=>e+1))}),[m,h,x]);const M=((e,t,o)=>{const i=e?0:s.iI.sm,n=e?0:s.iI.sm,l=t?"5px":0,r=o?"5px":0;return a.React.useMemo((()=>a.css`
      overflow: visible;
      white-space: nowrap;
      .controller-container {
        width: 100%;
        height: 100%;
        padding: ${r} ${l};
        min-width:  ${i}px;
        min-height: ${n}px;
      }
    `),[l,r,i,n])})(I,p,g),j=w(b,y);return(0,a.jsx)("div",{className:"widget-controller jimu-widget rw-controller",css:[M,j]},(0,a.jsx)("div",{className:"controller-container"},!R&&(0,a.jsx)(v,{id:r,version:k,config:d,autoSize:I}),R&&C&&(0,a.jsx)(C,{id:r,version:k,config:d,autoSize:I})))};b.versionManager=f},56037:(e,t,o)=>{"use strict";o(85160)},62838:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746z"></path></svg>'},68972:e=>{"use strict";e.exports=s},70687:(e,t,o)=>{"use strict";var a,i,n;o.d(t,{AH:()=>n,aL:()=>i,t2:()=>a}),function(e){e.Stack="STACK",e.SideBySide="SIDEBYSIDE"}(a||(a={})),function(e){e.Center="center",e.Start="start",e.End="end"}(i||(i={})),function(e){e.Arrows="ARROWS",e.PopupWindow="POPUP_WINDOW"}(n||(n={}))},79244:e=>{"use strict";e.exports=o},79298:e=>{"use strict";e.exports=d},85160:(e,t,o)=>{"use strict";var a=o(68972);var i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},n=a.useSyncExternalStore,l=a.useRef,r=a.useEffect,s=a.useMemo,d=a.useDebugValue}},t={};function c(o){var a=t[o];if(void 0!==a)return a.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,c),i.exports}c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},c.d=(e,t)=>{for(var o in t)c.o(t,o)&&!c.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.p="";var u={};return c.p=window.jimuConfig.baseUrl,(()=>{"use strict";c.r(u),c.d(u,{default:()=>H});var e=c(79244),t=c(17087),o=c(4108),a=c(28482),i=c(12279),n=c(42667),l=c(9567),r=c(41496),s=c(6055);const d={gap:0,padding:{number:[0],unit:"px"},header:{borderTop:{type:"solid",color:"var(--sys-color-primary-main)",width:"2px"},expandIcon:{svg:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M2.146 4.653a.485.485 0 0 1 .708 0L8 10.24l5.146-5.587a.485.485 0 0 1 .708 0 .54.54 0 0 1 0 .738l-5.5 5.956a.485.485 0 0 1-.708 0l-5.5-5.956a.54.54 0 0 1 0-.738" clip-rule="evenodd"></path></svg>',properties:{filename:"expand.svg",size:16,color:"var(--ref-palette-neutral-1200)",inlineSvg:!0}},collapseIcon:{svg:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M13.854 11.347a.486.486 0 0 1-.708 0L8 5.76l-5.146 5.587a.485.485 0 0 1-.708 0 .54.54 0 0 1 0-.738l5.5-5.956a.485.485 0 0 1 .708 0l5.5 5.956a.54.54 0 0 1 0 .738" clip-rule="evenodd"></path></svg>',properties:{filename:"collapse.svg",size:16,color:"var(--ref-palette-neutral-1200)",inlineSvg:!0}},showWidgetIcon:!1,widgetIconSize:16,widgetIconColor:"var(--ref-palette-white)",textStyle:{bold:!0,color:"var(--ref-palette-neutral-1200)",size:"14px"},padding:{number:[0],unit:"px"},borderRadius:{number:[0],unit:"px"},collapsedColor:"rgba(0,0,0,0)",expandedColor:"rgba(0,0,0,0)"},panel:{backgroundColor:"rgba(0,0,0,0)",borderRadius:{number:[0],unit:"px"},padding:{number:[0],unit:"px"},border:{color:"var(--sys-color-primary-main)",type:"solid",width:"0px"}},singleMode:!1,showToggleAll:!1,useQuickStyle:3};var p=function(e,t,o,a){return new(o||(o=Promise))((function(i,n){function l(e){try{s(a.next(e))}catch(e){n(e)}}function r(e){try{s(a.throw(e))}catch(e){n(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,r)}s((a=a.apply(e,t||[])).next())}))};const v=t=>{var o,a;let i=!0;const n=null==t?void 0:t.itemType,l=null===(o=null==t?void 0:t.manifest)||void 0===o?void 0:o.name;(n===e.LayoutItemType.Section||["controller","navigator","divider","menu"].includes(l))&&(i=!1);const s=(0,e.getAppStore)().getState(),d=(s.appStateInBuilder?s.appStateInBuilder:s).appRuntimeInfo.appMode===e.AppMode.Express,c=null===(a=null==t?void 0:t.manifest)||void 0===a?void 0:a.widgetType;return d&&(["arcgis-map"].includes(l)||c===e.WidgetType.Layout)&&(i=!1),r.utils.isWidgetPlaceholder(r.utils.getAppConfig(),t)&&(i=!1),i},g=(t,a,i)=>p(void 0,void 0,void 0,(function*(){const n=(0,o.getAppConfigAction)(),l=yield m(n,t,a,i);if(t.type===e.LayoutType.AccordionLayout){w(n,t.parent.id,[l])}return n.exec(),l})),m=(t,a,i,n)=>p(void 0,void 0,void 0,(function*(){const l=i.layoutInfo;let r;if(l&&l.layoutId&&l.layoutItemId){const n=(0,e.getAppStore)().getState().browserSizeMode;let l;l=i.isFromCurrentSizeMode?n:o.appConfigUtils.getSizeModeOfALayout(t.appConfig,i.layoutInfo.layoutId),r=t.moveLayoutItem(i.layoutInfo,a.id,l,n)}else if(i.uri){const e=yield t.addNewWidgetToLayout(a.id,{uri:i.uri,itemId:i.itemId},!0);r={layoutId:a.id,layoutItemId:e}}return t.adjustOrderOfItem(r,n||0,!0),t.editLayoutItemProperty(r,"bbox",{},!0),t.editLayoutItemProperty(r,"setting",{},!0),r})),h=(t,a)=>{var i,n,l,r,s,d,c,u;const p=(0,o.getAppConfigAction)();p.removeLayoutItem(t,!0,!0);const{layoutId:v,layoutItemId:g}=t;if(a){const e=null===(i=p.appConfig.widgets[a])||void 0===i?void 0:i.config,t=null===(r=null===(l=null===(n=p.appConfig.layouts[v])||void 0===n?void 0:n.content)||void 0===l?void 0:l[g])||void 0===r?void 0:r.widgetId;if(Array.isArray(null===(s=null==e?void 0:e.behavior)||void 0===s?void 0:s.openStarts)&&e.behavior.openStarts.includes(t)){const o=e.setIn(["behavior","openStarts"],e.behavior.openStarts.filter((e=>e!==t)));p.editWidgetConfig(a,o)}}p.exec();const m=(0,e.getAppStore)().getState(),h=m.appRuntimeInfo.selection;if(!h||(null==h?void 0:h.layoutId)===t.layoutId&&(null==h?void 0:h.layoutItemId)===t.layoutItemId){const t=null===(u=null===(c=null===(d=m.appConfig.widgets[a])||void 0===d?void 0:d.parent)||void 0===c?void 0:c[m.browserSizeMode])||void 0===u?void 0:u[0];(0,e.getAppStore)().dispatch(e.appActions.selectionChanged(t))}},f=(t,o)=>{var a,i;if(!t||!o)return null;return{id:t.id,layoutInfo:o,itemType:e.LayoutItemType.Widget,manifest:null===(a=t.manifest)||void 0===a?void 0:a.asMutable({deep:!0}),icon:"string"==typeof t.icon?t.icon:null===(i=t.icon)||void 0===i?void 0:i.asMutable({deep:!0}),label:t.label}},y=(t,o,a,i,n)=>p(void 0,void 0,void 0,(function*(){var l,r,s,d,c,u,p;const v={name:"accordion",label:"Group",uri:"widgets/layout/accordion/",icon:null,itemType:e.LayoutItemType.Widget,manifest:{widgetType:e.WidgetType.Layout,properties:{}}},g=yield m(t,o,v,n),h=null===(s=null===(r=null===(l=t.appConfig.layouts[o.id])||void 0===l?void 0:l.content)||void 0===r?void 0:r[g.layoutItemId])||void 0===s?void 0:s.widgetId,f=function(e,t){const o=Object.values((null==t?void 0:t.content)||{}).map((e=>e.widgetId)),a=null==e?void 0:e.widgets,i=Object.values(a||{}).filter((e=>o.includes(e.id)&&"widgets/layout/accordion/"===e.uri)).map((e=>e.label));return i}(t.appConfig,o),y=e.i18n.getIntl(),b=y?y.formatMessage({id:"groupLabel",defaultMessage:"Group"}):"Group";t.editWidgetProperty(h,"label",function(e,t="Group"){const o=new RegExp(`${t} [0-9]+`),a=e.filter((e=>o.test(e))),i=/\d+/,n=a.map((e=>{var t;return parseInt(null===(t=i.exec(e))||void 0===t?void 0:t[0])})),l=n.sort(((e,t)=>t-e))[0]||0;return`${t} ${l+1}`}(f,b)),t.adjustOrderOfItem(g,n,!0);const I=(0,e.getAppStore)().getState().browserSizeMode,S=null===(p=null===(u=null===(c=null===(d=t.appConfig.widgets)||void 0===d?void 0:d[h])||void 0===c?void 0:c.layouts)||void 0===u?void 0:u.DEFAULT)||void 0===p?void 0:p[I],x=t.appConfig.layouts[S],R=yield m(t,x,i,0),C=yield m(t,x,a,1);w(t,h,[R,C])}));function w(e,t,o){var a,i,n,l,s,c,u;const p=e.appConfig,v=(null===(i=null===(a=p.widgets[t].config)||void 0===a?void 0:a.asMutable)||void 0===i?void 0:i.call(a,{deep:!0}))||{};let g=v;3!==v.useQuickStyle&&(g=d);const m=v.expandedItems||[],h=[];for(const t of o){const{layoutId:o,layoutItemId:a}=t,i=null===(s=null===(l=null===(n=p.layouts[o])||void 0===n?void 0:n.content)||void 0===l?void 0:l[a])||void 0===s?void 0:s.widgetId,d=p.widgets[i];i&&h.push(i),(null===(c=d.manifest.properties)||void 0===c?void 0:c.supportAutoSize)?e.editLayoutItemProperty(t,"setting.autoProps.height",r.LayoutItemSizeModes.Auto,!0):(null===(u=d.manifest.defaultSize)||void 0===u?void 0:u.height)?e.editLayoutItemProperty(t,"bbox",{height:d.manifest.defaultSize.height+"px"},!0):e.editLayoutItemProperty(t,"bbox",{height:"300px"},!0)}g.expandedItems=m.concat(h),e.editWidgetConfig(t,g)}const b=e.React.forwardRef(((t,o)=>{const{layout:a,layouts:i,vertical:n,childClass:l,placeholder:d,className:c}=t,{color:u,size:[p,v]}=d,m=e.React.useRef(null),h=e.React.useRef(null),f=e.React.useRef(null),y=e.React.useRef(null),w=e.React.useRef(null),[b,I]=e.React.useState(!1),S=e.hooks.useForkRef(m,o),x=e.css`
    width: 100%;
    height: 100%;
    position: absolute;
    left: 0;
    bottom: 0;
    top: 0;
    right: 0;
    background: transparent;
    z-index: ${b?1:0};
    > .drop-area {
      width: 100%;
      height: 100%;
    }
    > .overlay {
      position: absolute;
      left: 0;
      bottom: 0;
      top: 0;
      right: 0;
      background: transparent;
      z-index: -1;
      &.hide {
        display: none;
      }
    }
  `;e.React.useEffect((()=>{h.current=new s.CanvasPane(w.current)}),[]);return(0,e.jsx)("div",{className:(0,e.classNames)("drop-zone",c),ref:S,css:x},(0,e.jsx)(s.DropArea,{style:x,className:"drop-area",layouts:i,highlightDragover:!0,onDragOver:(e,t,o,a,i,l)=>{let r=a;const s=y.current,d=m.current.offsetHeight,c=m.current.offsetWidth;if(s&&s.length)if(n){const{insertY:e,refId:t}=((e,t,o)=>{let a,i,n=!1;if(t.some(((e,l)=>{if(e.top+e.height/2>o){if(0===l)a=e.top;else{const o=t[l-1];a=(e.top+o.top+o.height)/2}n=!0,i=e.id}return n})),!n){const e=t[t.length-1];a=e.top+e.height}return{insertY:a,refId:i}})(0,s,l);f.current=t,r={top:e-v/2+m.current.scrollTop,width:p,left:(c-p)/2+m.current.scrollLeft,height:v}}else{const{insertX:e,refId:t}=((e,t,o)=>{let a,i,n=!1;if(t.some(((e,l)=>{if(e.left+e.width/2>o){if(0===l)a=e.left;else{const o=t[l-1];a=(e.left+o.left+o.width)/2}n=!0,i=e.id}return n})),!n){const e=t[t.length-1];a=e.left+e.width}return{insertX:a,refId:i}})(0,s,i);f.current=t,r={left:e-v/2+m.current.scrollLeft,width:v,top:(d-p)/2+m.current.scrollTop,height:p}}else r=n?{top:o.height/2-v/2,width:p,left:(c-p)/2+m.current.scrollLeft,height:v}:{left:o.width/2-v/2,width:v,top:(d-p)/2+m.current.scrollTop,height:p};h.current.clear(),h.current.setColor(u),h.current.drawRect(r)},onDrop:(e,t,o)=>{h.current.clear();let i=0;f.current?i=a.order&&a.order.indexOf(f.current)||0:a.order&&(i=a.order.length),g(a,e,i),f.current=null,y.current=[]},onToggleDragoverEffect:e=>{e&&(f.current=null,(()=>{y.current=[];const e=m.current.getBoundingClientRect(),t=m.current.parentNode.querySelectorAll(`.${l}`);t&&t.length&&t.forEach((t=>{const o=t.getAttribute("data-layoutitemid");if(a.order&&a.order.includes(o)){const a=r.utils.relativeClientRect(t.getBoundingClientRect(),e);a.id=o,y.current.push(a)}})),n?y.current.sort(((e,t)=>e.top-t.top)):y.current.sort(((e,t)=>e.left-t.left))})(),h.current.setSize(m.current.clientWidth,m.current.clientHeight)),I(e)}}),(0,e.jsx)("canvas",{className:(0,e.classNames)("overlay",{hide:!b}),ref:w}))})),I=(0,s.withRnd)(!1)(i.GD),S=t=>{const{className:o,draggable:a,layoutId:i,layoutItem:n,onClick:l,showLabel:r,showIndicator:s,showTooltip:d,labelGrowth:c,markerEnabled:u,avatar:p,active:v,removeWidget:g}=t;return e.React.createElement(I,{className:(0,e.classNames)(o,"layout-item","align-items-center"),layoutId:i,layoutItem:n,widgetid:n.widgetId,layoutItemId:n.id,markerEnabled:u,showLabel:r,showIndicator:s,showTooltip:d,labelGrowth:c,avatar:p,active:v,editDraggable:a,useDragHandler:!0,onClick:l,onMarkerClick:()=>{g(n.widgetId)}})};var x=c(1888),R=c(70687),C=c(4843);const k=e.React.forwardRef(((o,i)=>{const{controllerId:s,draggable:d,itemStyle:c,vertical:u,className:p,space:g,alignment:m,overflownStyle:f=R.AH.Arrows,onItemClick:y,markerEnabled:w=!0,autoSize:I,advanced:k,placeholder:A,onMouseDown:M}=o,j=e.ReactRedux.useSelector((e=>{var o,a,i;return null===(i=null===(a=null===(o=e.appConfig.widgets)||void 0===o?void 0:o[s])||void 0===a?void 0:a.layouts)||void 0===i?void 0:i[t.bC]})),z=(0,a.af)(s,t.bC),L=(0,a.ne)(z),T=(0,x.getBuilderThemeVariables)(),O=(0,a.PG)(s,t.bC),E=Object.keys(O).filter((e=>(0,a.V5)(O[e]))),P=(0,l._)(c,g),$={color:e.polished.rgba(null==T?void 0:T.sys.color.primary.light,.5),size:[P,t.Gt]},N=(t,o,a,i)=>{const n=z.content[t],l=n&&n.widgetId||"",r=E.includes(l);return e.React.createElement(S,{key:t,className:(0,e.classNames)(`layout-${null==z?void 0:z.id}-item layout-item`,o),layoutId:z.id,layoutItemId:t,draggable:d&&!i,markerEnabled:w,layoutItem:n,active:r,showLabel:c.showLabel,showIndicator:c.showIndicator,showTooltip:c.showTooltip,labelGrowth:c.labelGrowth,avatar:c.avatar,removeWidget:()=>{h({layoutId:z.id,layoutItemId:t},s)},onClick:e=>{null==a||a(e),null==y||y(e)}})};return z&&e.React.createElement(r.LayoutContext.Provider,{value:{isItemAccepted:v}},e.React.createElement("div",{ref:i,className:(0,e.classNames)(p,"layout controller-layout w-100 h-100 d-flex align-items-center justify-content-center"),"data-layoutid":z.id},e.React.createElement(b,{vertical:u,layout:z,childClass:`layout-${z.id}-item`,placeholder:$,layouts:j}),!A&&f===R.AH.PopupWindow&&e.React.createElement(C.z,{className:"popup-list",vertical:u,space:g,itemStyle:c,alignment:m,lists:L,createItem:N,itemLength:P,autoSize:I,advanced:k,onMouseDown:M}),!A&&f===R.AH.Arrows&&e.React.createElement(n.Q,{controllerId:s,autoSize:I,className:"layout-item-list",vertical:u,itemLength:P,space:g,alignment:m,lists:L,autoScrollEnd:!0,createItem:N,onMouseDown:M}),A))}));var A=c(20863),M=c(68972);c(56037);function j(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function z(e,t){if(j(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const o=Object.keys(e),a=Object.keys(t);if(o.length!==a.length)return!1;for(let a=0;a<o.length;a++)if(!Object.prototype.hasOwnProperty.call(t,o[a])||!j(e[o[a]],t[o[a]]))return!1;return!0}Object.defineProperty,Object.getOwnPropertyNames,Object.getOwnPropertySymbols,Object.getOwnPropertyDescriptor,Object.getPrototypeOf,Object.prototype;"undefined"!=typeof globalThis&&globalThis;const L={rootBoundary:"viewport",crossAxis:!0},T={boundary:document.body,fallbackPlacements:["top-start","bottom-start"]};function O(o){const{id:i}=o,{layoutId:n,layoutItem:l}=e.ReactRedux.useSelector((e=>{var o;const n=null===(o=e.appRuntimeInfo)||void 0===o?void 0:o.selection,l=(0,a.lL)(i,t.bC);let r,s;return n&&n.layoutId===l.id&&l.content[n.layoutItemId]&&(r=n.layoutId,s=l.content[n.layoutItemId]),{layoutId:r,layoutItem:s}}),z),[r,d]=e.React.useState(null);e.React.useEffect((()=>{if(n&&l){let e=0;const t=setInterval((()=>{e++;const o=document.querySelector(`.single-widget-launcher:has(.widget-renderer[data-widgetid=${null==l?void 0:l.widgetId}])`)||document.querySelector(`.multiple-widget-launcher:has(.widget-renderer[data-widgetid=${null==l?void 0:l.widgetId}])`)||document.querySelector(`.mobile-panel-popper:has(.widget-renderer[data-widgetid=${null==l?void 0:l.widgetId}])`);d(o),(e>=20||o)&&clearInterval(t)}),100)}else d(null)}),[n,l]);const c=e.hooks.useTranslation();return n&&l&&r&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(s.LayoutItemToolbar,{key:n+l.id,layoutId:n,layoutItem:l,refElement:r,shiftOptions:L,flipOptions:T,builderTheme:(0,x.getTheme2)(),formatMessage:c,showDefaultTools:!1}))}var E=c(53716);const P=(e,t,o)=>{var a;return null===(a=e[o.widgetId])||void 0===a?void 0:a.label},$=(e,t)=>`${t.widgetId||""},${e},${t.id}`,N=i=>{const n=(0,a.af)(i,t.bC),l=e.ReactRedux.useSelector((e=>{if(!n)return;const t=e.appConfig.widgets,o=null==n?void 0:n.content,l=(0,a.ne)(n).map((e=>o[e])).map((e=>{var o;const i=e.widgetId,l=t[i];let r;if("accordion"===(null===(o=null==l?void 0:l.manifest)||void 0===o?void 0:o.name)){const e=(0,a.lL)(i,"DEFAULT"),o=(0,a.ne)(e).map((t=>{var o;return null===(o=e.content)||void 0===o?void 0:o[t]}));r=o.map((o=>({itemKey:$(e.id,o),itemStateTitle:P(t,e.id,o)}))).filter((e=>!!e.itemStateTitle))}return{itemKey:$(n.id,e),itemStateTitle:P(t,n.id,e),itemChildren:r,itemStateExpanded:!!r}})).filter((e=>!!e.itemStateTitle));return{itemKey:i,itemChildren:l}}),e.lodash.isDeepEqual),r=M.default.useCallback((t=>{var o,a,i,n,l,r,s;const{draggingItemJsons:d,targetItemJsons:c,dropType:u}=t,p=(0,e.getAppStore)().getState().appConfig.widgets,[v]=d[0].itemKey.split(","),g=p[v],[m]=null===(i=null===(a=null===(o=null==c?void 0:c[1])||void 0===o?void 0:o.itemKey)||void 0===a?void 0:a.split)||void 0===i?void 0:i.call(a,","),h=p[m];return("to-inside"!==u||"accordion"!==(null===(n=null==g?void 0:g.manifest)||void 0===n?void 0:n.name)&&"accordion"!==(null===(l=null==h?void 0:h.manifest)||void 0===l?void 0:l.name))&&(!["to-top","to-bottom"].includes(u)||"accordion"!==(null===(r=null==g?void 0:g.manifest)||void 0===r?void 0:r.name)||"accordion"!==(null===(s=null==h?void 0:h.manifest)||void 0===s?void 0:s.name))}),[]),s=M.default.useCallback((t=>{var i,l,r,s,d,c,u,v;const{dragItemJsons:m,dragItemIndex:h,itemJsons:w,targetDropItemIndex:b}=t,I=(0,e.getAppStore)().getState().appConfig.widgets,[S,x,R]=m[0].itemKey.split(","),C={layoutId:x,layoutItemId:R},k=I[S],[A,M,j]=w[0].itemKey.split(","),z={layoutId:M,layoutItemId:j},L=I[A],T=f(k,C),O=f(L,z),[E]=null===(r=null===(l=null===(i=null==m?void 0:m[1])||void 0===i?void 0:i.itemKey)||void 0===l?void 0:l.split)||void 0===r?void 0:r.call(l,","),[P]=null===(c=null===(d=null===(s=null==w?void 0:w[1])||void 0===s?void 0:s.itemKey)||void 0===d?void 0:d.split)||void 0===c?void 0:c.call(d,","),$=I[P];if("to-inside"===t.dropType&&T&&O){const t=null===(u=null==w?void 0:w[1])||void 0===u?void 0:u.itemChildren.indexOf(null==w?void 0:w[0]);if("accordion"===O.manifest.name){const e=(0,a.lL)(A,"DEFAULT");g(e,T,t)}else if("accordion"!==O.manifest.name){((t,a,i,n,l,...r)=>{p(void 0,[t,a,i,n,l,...r],void 0,(function*(t,a,i,n,l,r=!0){var s,d,c,u,p,v;const g=(0,o.getAppConfigAction)(),m=r&&i<l?l-1:l;yield y(g,t,a,n,m),g.exec();const h=a.id?[a.id,n.id]:[n.id];(0,e.getAppStore)().dispatch(e.appActions.closeWidgets(h));const f=(0,e.getAppStore)().getState(),w=f.appRuntimeInfo.selection;if(!w||(null==w?void 0:w.layoutId)===t.id&&[null===(s=a.layoutInfo)||void 0===s?void 0:s.layoutItemId,null===(d=n.layoutInfo)||void 0===d?void 0:d.layoutItemId].includes(null==w?void 0:w.layoutItemId)){const o=null===(c=t.parent)||void 0===c?void 0:c.id,a=null===(v=null===(p=null===(u=f.appConfig.widgets[o])||void 0===u?void 0:u.parent)||void 0===p?void 0:p[f.browserSizeMode])||void 0===v?void 0:v[0];(0,e.getAppStore)().dispatch(e.appActions.selectionChanged(a))}}))})(n,T,h,O,t,E===P)}}else if(["to-top","to-bottom"].includes(t.dropType)&&T){let e=n;"accordion"===(null===(v=null==$?void 0:$.manifest)||void 0===v?void 0:v.name)&&(e=(0,a.lL)(P,"DEFAULT")),g(e,T,b)}}),[n]),d=M.default.useCallback((e=>{const[,t,o]=e.itemKey.split(",");h({layoutId:t,layoutItemId:o},i)}),[i]),c=(0,a.H9)(i);M.default.useEffect((()=>{c&&((0,e.getAppStore)().dispatch(e.appActions.widgetStatePropChange(i,"widgetTreeJson",l)),(0,e.getAppStore)().dispatch(e.appActions.widgetStatePropChange(i,"isItemDroppable",r)),(0,e.getAppStore)().dispatch(e.appActions.widgetStatePropChange(i,"onTreeSort",s)),(0,e.getAppStore)().dispatch(e.appActions.widgetStatePropChange(i,"onTreeRemove",d)))}),[i,r,c,d,s,l])};var B=function(e,t,o,a){return new(o||(o=Promise))((function(i,n){function l(e){try{s(a.next(e))}catch(e){n(e)}}function r(e){try{s(a.throw(e))}catch(e){n(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,r)}s((a=a.apply(e,t||[])).next())}))};const W=(o,i)=>{const n=e.React.useCallback((e=>B(void 0,void 0,void 0,(function*(){var n,l;const r=(0,a.lL)(o,t.bC),s=null!==(l=null===(n=r.order)||void 0===n?void 0:n.length)&&void 0!==l?l:0;try{const t=yield g(r,e,s);i(t)}catch(e){console.error("Failed to add widget")}}))),[o,i]),l=e.ReactRedux.useSelector((e=>{var t;return null===(t=e.widgetsState[o])||void 0===t?void 0:t.itemToAdd}));e.React.useEffect((()=>{l&&(n(l),(0,e.getAppStore)().dispatch(e.appActions.widgetStatePropChange(o,"itemToAdd",null)))}),[o,l,n])};var D=c(79298);const F=t=>e.css`
width: 300px;
height: 400px;
overflow-y: auto;
padding: ${t.sys.spacing[4]};
.jimu-tree-item__main-line {
  height: 32px;
  background-color: ${t.ref.palette.neutral[500]};
  &:hover {
    background-color: ${t.ref.palette.neutral[600]};
  }
  color: ${t.ref.palette.neutral[1100]};
}
.jimu-tree-item__body {
  border: none !important;
}
`,H={Builder:n=>{var l,s;const{id:d,config:c,version:u,autoSize:p}=n,v=e.hooks.useCheckSmallBrowserSizeMode(),{viewOnly:g}=e.React.useContext(r.PageContext),m=e.ReactRedux.useSelector((t=>t.appRuntimeInfo.appMode===e.AppMode.Express)),h=e.React.useRef(null),f=(0,a.PG)(d,t.bC),y=!Object.keys(null!=f?f:{}).length;e.hooks.useUpdateEffect((()=>{(0,e.getAppStore)().dispatch(e.appActions.widgetToolbarStateChange(d,["controller-manage-widgets"]))}),[d,y]);const w=e.React.useRef([0,0]),b=Object.keys(f).filter((e=>(0,a.V5)(f[e]))),I=null===(l=c.behavior)||void 0===l?void 0:l.onlyOpenOne,S=!!v||I,x=e.ReactRedux.useSelector((e=>e.browserSizeMode!==e.appConfig.mainSizeMode)),R=c.behavior.vertical,C=c.appearance.card,M=c.appearance.space,j=c.behavior.alignment,z=c.behavior.overflownStyle,L=e.React.useMemo((()=>{var t;return(0,e.jsx)(i.i7,{size:null===(t=C.avatar)||void 0===t?void 0:t.size,space:R?M:C.labelGrowth,vertical:R,alignment:j})}),[j,null===(s=C.avatar)||void 0===s?void 0:s.size,C.labelGrowth,M,R]),T=e.hooks.useLatest(b),P=e.React.useCallback((t=>{t&&m&&setTimeout((()=>{var o,a,i;const n=null===(i=null===(a=null===(o=(0,e.getAppStore)().getState().appConfig.layouts[t.layoutId])||void 0===o?void 0:o.content)||void 0===a?void 0:a[t.layoutItemId])||void 0===i?void 0:i.widgetId;(0,E.xu)(d,n,T.current,S,!0)}),50)}),[d,m,S,T]);return W(d,P),N(d),(0,e.jsx)("div",{className:"controller-builder w-100 h-100",ref:h},(0,e.jsx)(A.A,{id:d,config:c,version:u,rootRef:h,onResizeStop:(t,a)=>{if(!t)return;let i=(null==c?void 0:c.behavior.size)||(0,e.Immutable)({});i=i.set(t,a);const n=c.setIn(["behavior","size"],i);(0,o.getAppConfigAction)().editWidgetConfig(d,n).exec()}}),!m&&(0,e.jsx)(O,{id:d}),(0,e.jsx)(k,{autoSize:p,vertical:R,controllerId:d,onItemClick:e=>{var t;const o=null===(t=e.currentTarget.dataset)||void 0===t?void 0:t.widgetid,a=w.current[0]!==e.clientX||w.current[1]!==e.clientY;o&&!a&&(b.includes(o)||e.stopPropagation(),(0,E.xu)(d,o,b,S,!(g||m&&x)))},onMouseDown:e=>{w.current=[e.clientX,e.clientY]},itemStyle:C,draggable:!0,markerEnabled:!g&&!m,space:M,alignment:j,overflownStyle:z,placeholder:y?L:null,advanced:c.appearance.advanced}))},ManageWidgetsComponent:t=>{var o,a;const i=t.widgetId,n=null===(a=null===(o=e.ReactRedux.useSelector((e=>(e.appStateInBuilder?e.appStateInBuilder:e).widgetsState[i].widgetTreeJson)))||void 0===o?void 0:o.asMutable)||void 0===a?void 0:a.call(o,{deep:!0}),l=e.ReactRedux.useSelector((e=>(e.appStateInBuilder?e.appStateInBuilder:e).widgetsState[i].isItemDroppable)),r=e.ReactRedux.useSelector((e=>(e.appStateInBuilder?e.appStateInBuilder:e).widgetsState[i].onTreeSort)),s=e.ReactRedux.useSelector((e=>(e.appStateInBuilder?e.appStateInBuilder:e).widgetsState[i].onTreeRemove)),d=(0,x.useTheme)();return(0,e.jsx)("div",{css:F(d)},(0,e.jsx)(D.SortTree,{rootItemJson:n,isItemDroppable:l,onSort:r,onRemove:s}))}}})(),u})())}}}));