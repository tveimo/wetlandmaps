System.register(["jimu-core","jimu-ui","jimu-ui/advanced/setting-components","jimu-arcgis","jimu-for-builder","jimu-ui/basic/list-tree","jimu-ui/advanced/data-source-selector","jimu-theme","jimu-layouts/layout-runtime","jimu-ui/advanced/style-setting-components","jimu-ui/basic/color-picker","jimu-core/react"],(function(e,t){var a={},i={},l={},n={},o={},s={},r={},c={},d={},u={},m={},g={};return{setters:[function(e){a.CONSTANTS=e.CONSTANTS,a.DataSourceComponent=e.DataSourceComponent,a.DataSourceManager=e.DataSourceManager,a.DataSourceTypes=e.DataSourceTypes,a.Immutable=e.Immutable,a.JSAPILayerTypes=e.JSAPILayerTypes,a.JimuFieldType=e.JimuFieldType,a.React=e.React,a.ReactRedux=e.ReactRedux,a.classNames=e.classNames,a.css=e.css,a.dataSourceUtils=e.dataSourceUtils,a.defaultMessages=e.defaultMessages,a.hooks=e.hooks,a.jsx=e.jsx,a.polished=e.polished},function(e){i.Alert=e.Alert,i.Button=e.Button,i.Checkbox=e.Checkbox,i.ConfirmDialog=e.ConfirmDialog,i.DistanceUnits=e.DistanceUnits,i.Icon=e.Icon,i.Label=e.Label,i.Loading=e.Loading,i.LoadingType=e.LoadingType,i.PanelHeader=e.PanelHeader,i.Radio=e.Radio,i.Select=e.Select,i.Switch=e.Switch,i.TextInput=e.TextInput,i.Tooltip=e.Tooltip,i.defaultMessages=e.defaultMessages},function(e){l.JimuLayerViewSelector=e.JimuLayerViewSelector,l.MapWidgetSelector=e.MapWidgetSelector,l.SettingRow=e.SettingRow,l.SettingSection=e.SettingSection,l.SidePopper=e.SidePopper},function(e){n.JimuMapViewComponent=e.JimuMapViewComponent},function(e){o.builderAppSync=e.builderAppSync},function(e){s.List=e.List,s.Tree=e.Tree,s.TreeAlignmentType=e.TreeAlignmentType,s.TreeItemActionType=e.TreeItemActionType},function(e){r.DataSourceSelector=e.DataSourceSelector,r.FieldSelector=e.FieldSelector,r.FieldSelectorWithFullTextIndex=e.FieldSelectorWithFullTextIndex,r.dataComponentsUtils=e.dataComponentsUtils},function(e){c.useTheme=e.useTheme,c.useTheme2=e.useTheme2},function(e){d.defaultMessages=e.defaultMessages},function(e){u.FontStyle=e.FontStyle,u.InputUnit=e.InputUnit},function(e){m.ThemeColorPicker=e.ThemeColorPicker},function(e){g.Fragment=e.Fragment}],execute:function(){e((()=>{var e={778:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8.829 2.535a.909.909 0 0 0-1.657 0L2.291 13.356a.456.456 0 0 0 .831.377L4.818 10h6.365l1.696 3.733a.456.456 0 0 0 .831-.377zM5.272 9 8 3l2.729 6z" clip-rule="evenodd"></path></svg>'},1888:e=>{"use strict";e.exports=c},4108:e=>{"use strict";e.exports=o},8377:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA5IiBoZWlnaHQ9IjcwIiB2aWV3Qm94PSIwIDAgMTA5IDcwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHJlY3QgeD0iOCIgeT0iOCIgd2lkdGg9IjkzIiBoZWlnaHQ9IjU0IiByeD0iMiIgZmlsbD0iIzI4MjgyOCIvPg0KPHJlY3QgeD0iMzIiIHk9IjI0IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iMzIiIHk9IjMyIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjM5IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjQ2IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjUzIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjI0IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iMTIiIHk9IjMyIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjM5IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjQ2IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjUzIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjEyIiB3aWR0aD0iMzgiIGhlaWdodD0iOCIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMTQiIHk9IjE0IiB3aWR0aD0iMjgiIGhlaWdodD0iNCIgZmlsbD0iIzE4MTgxOCIvPg0KPHBhdGggZD0iTTQ0IDE1SDQ4TDQ2IDE3TDQ0IDE1WiIgZmlsbD0iIzE4MTgxOCIvPg0KPHJlY3QgeD0iNTIiIHk9IjI0IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iNTIiIHk9IjMyIiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjM5IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjQ2IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjUzIiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjI0IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iNzMiIHk9IjMyIiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjM5IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjQ2IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjUzIiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPC9zdmc+DQo="},13089:e=>{"use strict";e.exports=r},14321:e=>{"use strict";e.exports=i},15562:e=>{"use strict";e.exports=u},23662:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M7.5 0a.5.5 0 0 0-.5.5V7H.5a.5.5 0 0 0 0 1H7v6.5a.5.5 0 0 0 1 0V8h6.5a.5.5 0 0 0 0-1H8V.5a.5.5 0 0 0-.5-.5"></path></svg>'},26490:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M3.154 3.154a.527.527 0 0 1 .746 0l1.317 1.317A8.6 8.6 0 0 1 8 4c2.667 0 5.667 1.333 7 4-.696 1.393-1.847 2.422-3.168 3.087l1.014 1.013a.527.527 0 1 1-.746.746l-1.317-1.317A8.6 8.6 0 0 1 8 12c-2.667 0-5.667-1.333-7-4 .696-1.393 1.847-2.422 3.168-3.087L3.154 3.9a.527.527 0 0 1 0-.746m1.698 2.443C3.726 6.087 2.782 6.882 2 8c1.422 2.033 3.382 3 6 3a8.7 8.7 0 0 0 2.03-.225l-.675-.674A2.5 2.5 0 0 1 5.9 6.644zm6.296 4.805C12.275 9.913 13.218 9.119 14 8c-1.422-2.033-3.382-3-6-3q-1.088 0-2.03.225l.675.674a2.5 2.5 0 0 1 3.457 3.456zM6.5 8c0-.221.048-.431.134-.62l1.987 1.986A1.5 1.5 0 0 1 6.5 8m.88-1.366 1.986 1.987a1.5 1.5 0 0 0-1.987-1.987" clip-rule="evenodd"></path></svg>'},28996:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 2.125 14.334 14H1.667zm-.882-.47a1 1 0 0 1 1.765 0l6.333 11.874A1 1 0 0 1 14.334 15H1.667a1 1 0 0 1-.882-1.47zM8 4.874a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0L8.9 5.87a.905.905 0 0 0-.9-.995m1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd"></path></svg>'},30655:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2.146 4.653a.485.485 0 0 1 .708 0L8 10.24l5.146-5.587a.485.485 0 0 1 .708 0 .54.54 0 0 1 0 .738l-5.5 5.956a.485.485 0 0 1-.708 0l-5.5-5.956a.54.54 0 0 1 0-.738" clip-rule="evenodd"></path></svg>'},31027:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5c0 .527-.074 1.036-.212 1.518l.912.438a6.5 6.5 0 1 0-6.586 4.533l-.077-1.008A5.5 5.5 0 1 1 12 6.5m-9 0a3.5 3.5 0 0 0 2.88 3.445L5.8 8.901a2.501 2.501 0 1 1 3.194-2.224l.949.456A3.5 3.5 0 1 0 3 6.5M15.5 11l-5 1-3 4-1-9.5zm-5.57.094-1.702 2.269-.542-5.152 4.76 2.38z" clip-rule="evenodd"></path></svg>'},41496:e=>{"use strict";e.exports=d},53195:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M0 3.307V15l5.722-2.117 4.528 1.937L16 12.693V1l-5.722 2.117L5.75 1.18zm1 10.286V3.974l4-1.48v9.619zm5-1.65 4 1.711V4.057L6 2.346zm5 1.563V3.887l4-1.48v9.619z" clip-rule="evenodd"></path></svg>'},54337:e=>{"use strict";e.exports=m},62686:e=>{"use strict";e.exports=n},62838:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746z"></path></svg>'},68972:e=>{"use strict";e.exports=g},72529:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8.027 0A8 8 0 1 1 0 8a8 8 0 0 1 8.027-8m-2.07 1.303A7 7 0 0 0 2.256 4h1.6a8.3 8.3 0 0 1 2.103-2.697M3.453 5H1.674a7 7 0 0 0-.656 2.5H3.01q.06-1.336.441-2.5m.56 2.5a8.1 8.1 0 0 1 .5-2.5H7.5v2.5zm-1.001 1H1.018c.062.89.291 1.733.656 2.5h1.778a9.3 9.3 0 0 1-.441-2.5M4.512 11a8.1 8.1 0 0 1-.5-2.5H7.5V11zm-.657 1h-1.6a7 7 0 0 0 3.702 2.697A8.3 8.3 0 0 1 3.855 12M7.5 14.61V12H4.985q.869 1.516 2.515 2.61M7.5 4V1.39Q5.854 2.484 4.985 4zm2.543 10.697A7 7 0 0 0 13.745 12h-1.6a8.3 8.3 0 0 1-2.102 2.697M12.548 11h1.778c.365-.767.594-1.61.656-2.5H12.99a9.3 9.3 0 0 1-.441 2.5m-.56-2.5a8.1 8.1 0 0 1-.5 2.5H8.5V8.5zm1.001-1h1.993a7 7 0 0 0-.656-2.5h-1.778q.381 1.164.441 2.5M11.488 5q.434 1.146.5 2.5H8.5V5zm.657-1h1.6a7 7 0 0 0-3.703-2.697Q11.408 2.473 12.145 4M8.5 1.39Q10.146 2.484 11.015 4H8.5zM8.5 12h2.515q-.869 1.516-2.515 2.61z" clip-rule="evenodd"></path></svg>'},73529:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 12c-2.667 0-5.667-1.333-7-4 1.333-2.667 4.333-4 7-4s5.667 1.333 7 4c-1.333 2.667-4.333 4-7 4m0-7c-2.618 0-4.578.967-6 3 1.422 2.033 3.382 3 6 3s4.578-.967 6-3c-1.422-2.033-3.382-3-6-3m0 5.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5m0-1a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3" clip-rule="evenodd"></path></svg>'},79226:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA5IiBoZWlnaHQ9IjcwIiB2aWV3Qm94PSIwIDAgMTA5IDcwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHJlY3QgeD0iOCIgeT0iOCIgd2lkdGg9IjkzIiBoZWlnaHQ9IjU0IiByeD0iMiIgZmlsbD0iIzI4MjgyOCIvPg0KPHJlY3QgeD0iMzIiIHk9IjI0IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iMzIiIHk9IjMyIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjM5IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjQ2IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjUzIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjI0IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iMTIiIHk9IjMyIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjM5IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjQ2IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjUzIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjE5IiB3aWR0aD0iODUiIGhlaWdodD0iMSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjE5IiB3aWR0aD0iMTYiIGhlaWdodD0iMSIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMTIiIHk9IjEzIiB3aWR0aD0iMTYiIGhlaWdodD0iNiIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMzAiIHk9IjEzIiB3aWR0aD0iMTYiIGhlaWdodD0iNiIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNDgiIHk9IjEzIiB3aWR0aD0iMTYiIGhlaWdodD0iNiIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjI0IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iNTIiIHk9IjMyIiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjM5IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjQ2IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjUzIiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjI0IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iNzMiIHk9IjMyIiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjM5IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjQ2IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjUzIiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPC9zdmc+DQo="},79244:e=>{"use strict";e.exports=a},79298:e=>{"use strict";e.exports=l},93303:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M9.438.994c.213 0 .397.146.44.35q.227 1.084.316 1.852.562.242 1.048.599l1.728-.676a.455.455 0 0 1 .556.188l1.42 2.394a.43.43 0 0 1-.091.547 22 22 0 0 1-1.49 1.194q.03.27.03.552 0 .32-.038.63l1.465 1.12a.43.43 0 0 1 .111.563l-1.42 2.394a.454.454 0 0 1-.53.197 23 23 0 0 1-1.807-.66q-.49.35-1.055.586l-.263 1.794a.446.446 0 0 1-.445.376H6.574a.446.446 0 0 1-.44-.35 21 21 0 0 1-.317-1.853 5.3 5.3 0 0 1-1.047-.598l-1.728.675a.455.455 0 0 1-.556-.187l-1.42-2.395a.43.43 0 0 1 .091-.546q.85-.735 1.49-1.194a5.167 5.167 0 0 1 .008-1.183L1.19 6.243a.43.43 0 0 1-.112-.562l1.42-2.395a.455.455 0 0 1 .531-.196q1.078.35 1.807.66c.324-.233.679-.43 1.056-.587l.262-1.794A.446.446 0 0 1 6.6.994zm-.365 1H6.985l-.28 1.866-.467.19q-.353.144-.672.34l-.207.136-.42.293-.476-.197q-.492-.205-1.169-.433l-.221-.074-1.045 1.719L3.59 6.999l-.06.479a4 4 0 0 0-.021.816l.014.144.058.492-.419.294q-.433.304-.979.746l-.177.145 1.043 1.72 1.845-.703.406.29q.307.219.645.384l.228.103.474.199.059.49q.06.507.19 1.177l.043.219h2.088l.282-1.867.466-.19q.354-.144.672-.34l.207-.136.419-.293.476.198q.495.204 1.17.433l.22.072 1.044-1.718-1.56-1.165.06-.479a4 4 0 0 0 .02-.815l-.013-.144-.06-.492.42-.295a18 18 0 0 0 .98-.746l.176-.146-1.043-1.72-1.844.705-.406-.29a4.5 4.5 0 0 0-.646-.385l-.228-.103-.474-.199-.058-.49q-.049-.405-.14-.916zm-1.067 3a3 3 0 1 1 0 6 3 3 0 0 1 0-6m0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4" clip-rule="evenodd"></path></svg>'},94064:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M13.854 11.347a.486.486 0 0 1-.708 0L8 5.76l-5.146 5.587a.485.485 0 0 1-.708 0 .54.54 0 0 1 0-.738l5.5-5.956a.485.485 0 0 1 .708 0l5.5 5.956a.54.54 0 0 1 0 .738" clip-rule="evenodd"></path></svg>'},98640:e=>{"use strict";e.exports=s}},t={};function p(a){var i=t[a];if(void 0!==i)return i.exports;var l=t[a]={exports:{}};return e[a](l,l.exports,p),l.exports}p.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return p.d(t,{a:t}),t},p.d=(e,t)=>{for(var a in t)p.o(t,a)&&!p.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},p.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),p.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},p.p="";var I={};return p.p=window.jimuConfig.baseUrl,(()=>{"use strict";p.r(I),p.d(I,{__set_webpack_public_path__:()=>Ze,default:()=>Ke});var e,t,a,i,l,n,o,s=p(79244),r=p(14321),c=p(79298),d=p(62686);!function(e){e.Layer="LAYER",e.Map="MAP"}(e||(e={})),function(e){e.Dropdown="DROPDOWN",e.Tabs="TABS"}(t||(t={})),function(e){e.Start="start",e.Center="center",e.End="end"}(a||(a={})),function(e){e.Single="SINGLE",e.Multiple="MULTIPLE"}(i||(i={})),function(e){e.Webmap="WEBMAP",e.Custom="CUSTOM"}(l||(l={})),function(e){e.Fit="FIT",e.Fixed="FIXED"}(n||(n={})),function(e){e.View="VIEW",e.Add="ADD"}(o||(o={}));const u={newSheet:"New sheet",sheetStyle:"Arrangement style",layerConfig:"Sheet configuration",enableAttachments:"Show attachments",enableSearch:"Search",searchFields:"Select searching fields",fullMatch:"Exact match",allowCsv:"Allow exporting to CSV",enableSelect:"Select records",enableEdit:"Allow editing",showCount:"Show record count",enableRefresh:"Refresh",enableShowHideColumn:"Show/hide columns",configFields:"Configure fields",dropdown:"Dropdown",configTips:"Select fields for initial display",tableBlankStatus:'Click the "{SheetString}" button to add and configure data sheets.',selectFields:"Select fields",checkAll:"Check all",uncheckAll:"Uncheck all",editable:"Editable",editableCount:"{count} Editable",tableOptions:"Table options",columnSize:"Column sizing",fitToData:"Fit to data",columnWidth:"Column width",updateText:"Last update text",layerHonorSetting:"Use layer settings",layerCustomize:"Customize",deleteRecords:"Delete records",noMapSelectedTips:"Select a map for further configurations.",changeModeConfirmTitle:"Are you sure you want to switch the mode?",changeModeConfirmTips:"You will lose the settings configured.",enableMapExtentFilter:"Filter by map extent",enableHighlightOnHover:"Highlight map features on hover",enableRelatedRecords:"Show related data",selectLayers:"Select layers",enableSyncVisibilities:"Synchronize with layer visibilities",displayRuntimeLayers:"Display layers generated at runtime",tableAction_OpenInSameTab:"Open in the same sheet"};var m=p(4108),g=p(23662),b=p.n(g),v=function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(i=Object.getOwnPropertySymbols(e);l<i.length;l++)t.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(e,i[l])&&(a[i[l]]=e[i[l]])}return a};const y=e=>{const t=window.SVG,{className:a}=e,i=v(e,["className"]),l=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:l,src:b()},i)):s.React.createElement("svg",Object.assign({className:l},i))};var h=p(98640),S=p(62838),f=p.n(S);const D={overrideItemBlockInfo:({itemBlockInfo:e},t)=>({name:h.TreeItemActionType.RenderOverrideItem,children:[{name:h.TreeItemActionType.RenderOverrideItemDroppableContainer,children:[{name:h.TreeItemActionType.RenderOverrideItemContent,children:[{name:h.TreeItemActionType.RenderOverrideItemBody,children:[{name:h.TreeItemActionType.RenderOverrideItemMainLine,children:[{name:h.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:h.TreeItemActionType.RenderOverrideItemDragHandle},{name:h.TreeItemActionType.RenderOverrideItemChildrenToggle},{name:h.TreeItemActionType.RenderOverrideItemIcon},{name:h.TreeItemActionType.RenderOverrideItemTitle},{name:h.TreeItemActionType.RenderOverrideItemDetailToggle},{name:h.TreeItemActionType.RenderOverrideItemCommands}]}]},{name:h.TreeItemActionType.RenderOverrideItemDetailLine}]}]}]}]})},x=(e,t)=>!!e&&(Array.isArray(e)?null==e?void 0:e.join().toLowerCase().includes(t):null==e?void 0:e.toLowerCase().includes(t)),j=(0,s.Immutable)([s.DataSourceTypes.FeatureLayer,s.DataSourceTypes.SceneLayer,s.DataSourceTypes.BuildingComponentSubLayer,s.DataSourceTypes.OrientedImageryLayer,s.DataSourceTypes.ImageryLayer,s.DataSourceTypes.SubtypeSublayer]),w=(0,s.Immutable)([s.DataSourceTypes.WebMap,s.DataSourceTypes.WebScene,s.DataSourceTypes.MapService,s.DataSourceTypes.FeatureService,s.DataSourceTypes.SceneService,s.DataSourceTypes.GroupLayer,s.DataSourceTypes.BuildingGroupSubLayer,s.DataSourceTypes.BuildingSceneLayer,s.DataSourceTypes.SubtypeGroupLayer]),M=(e,t,o,r)=>{var c,d,u;const m=e.getSchema(),g=null==e?void 0:e.getLayerDefinition(),p=(null==m?void 0:m.fields)?Object.values(null==m?void 0:m.fields):[],I=(null==g?void 0:g.fields)||[];let b=p.map((e=>{const t=I.find((t=>t.name===e.jimuName)),a=null==t?void 0:t.editable;return Object.assign(Object.assign({},e),{editAuthority:a,editable:a,visible:!0})}));const v=null===(c=null==e?void 0:e.getPopupInfo())||void 0===c?void 0:c.fieldInfos;if("output"!==e.dataViewId&&v&&(null==v?void 0:v.length)>0){const e=[];v.forEach((t=>{(null==t?void 0:t.visible)&&e.push(t.fieldName)})),b=b.filter((t=>e.includes(t.name)))}(null==b?void 0:b.length)>50&&(b=b.slice(0,50));const y=r||e,h={dataSourceId:y.id,mainDataSourceId:null===(d=y.getMainDataSource())||void 0===d?void 0:d.id,dataViewId:y.dataViewId,rootDataSourceId:null===(u=y.getRootDataSource())||void 0===u?void 0:u.id},S=(0,s.Immutable)(h),f=b.map((e=>e.jimuName)),D=S.set("fields",f);return{id:t?e.id:o?o(e.id):e.id,name:e.getLabel(),useDataSource:D.asMutable({deep:!0}),allFields:p,tableFields:b,enableAttachments:!1,enableEdit:!1,allowCsv:!1,enableSearch:!1,searchFields:[],enableRefresh:!0,enableShowHideColumn:!0,enableSelect:!0,enableDelete:!1,selectMode:i.Single,showCount:!0,headerFontSetting:{backgroundColor:"",fontSize:14,bold:!1,color:""},columnSetting:{responsiveType:n.Fixed,columnWidth:200,wrapText:!1,textAlign:a.Start},layerHonorMode:l.Webmap}},C=[s.JSAPILayerTypes.FeatureLayer,s.JSAPILayerTypes.SceneLayer,s.JSAPILayerTypes.BuildingComponentSublayer,s.JSAPILayerTypes.OrientedImageryLayer,s.JSAPILayerTypes.ImageryLayer,s.JSAPILayerTypes.SubtypeSublayer];function T(e){if(!e||!e.type)return!1;const t=e.type,a=t!==s.JSAPILayerTypes.BuildingComponentSublayer||t===s.JSAPILayerTypes.BuildingComponentSublayer&&e.view,i=C.includes(t);return a&&i}const R=e=>s.DataSourceManager.getInstance().getDataSource(e),N=e=>{const t=(null==e?void 0:e.type)===s.DataSourceTypes.SceneLayer||(null==e?void 0:e.type)===s.DataSourceTypes.BuildingComponentSubLayer;null==e||e.type,s.DataSourceTypes.OrientedImageryLayer,null==e||e.type,s.DataSourceTypes.ImageryLayer;let a;return a=t?e.getAssociatedDataSource():e,a};const k=e=>{const{layersConfig:t,activeIndex:a,failedDataSourceIds:i,onRemove:l,onSort:n,onClick:o}=e,d=s.hooks.useTranslation(r.defaultMessages,s.defaultMessages),u=t.length,m=s.React.useMemo((()=>t.asMutable({deep:!0}).map(((e,t)=>({itemStateDetailContent:e,itemKey:e.id,itemStateTitle:e.name,itemStateChecked:t===a,itemStateCommands:[{label:d("remove"),iconProps:()=>({icon:f(),size:12}),action:()=>{l(e.id)}}]})))),[a,t,l,d]),g=s.React.useMemo((()=>(0,s.jsx)(r.Alert,{variant:"text",form:"tooltip",size:"small",type:"error",text:d("dataSourceCreateError")})),[d]),p=s.React.useCallback(((e,t)=>{var a,l;const{itemJsons:n}=t.props,[o]=n,s=null===(l=null===(a=null==o?void 0:o.itemStateDetailContent)||void 0===a?void 0:a.useDataSource)||void 0===l?void 0:l.dataSourceId;return i.includes(s)||!R(s)?g:null}),[g,i]),I=s.React.useCallback(((e,t)=>{if("handleDidDrop"===e.updateType){const t=e.targetDropItemChildren.map((e=>e.itemKey));n(t)}}),[n]),b=s.React.useCallback(((e,t)=>{const{itemJsons:[a]}=t.props;o(a.itemKey)}),[o]),v=s.React.useMemo((()=>[{itemStateDetailContent:"......",itemKey:`${a}`,itemStateTitle:"......",itemStateChecked:!0,itemStateCommands:[]}]),[a]);return(0,s.jsx)(c.SettingRow,{className:"setting-ui-unit-list",css:s.css`
    display: block !important;
    &.setting-ui-unit-list {
      width: 100%;
      .tree-item {
        justify-content: space-between;
        align-items: center;
        font-size: 13px;
        &.tree-item_level-1 {
        }
        .jimu-checkbox {
          margin-right: 8px;
        }
      }
      .setting-ui-unit-list-new {
        padding-top: 4px;
      }
    }
  `},u>0&&(0,s.jsx)(h.List,Object.assign({className:"w-100",itemsJson:m,dndEnabled:!0,renderOverrideItemDetailToggle:p,onUpdateItem:I,onClickItemBody:b},D)),u===a&&(0,s.jsx)(h.List,Object.assign({className:"setting-ui-unit-list-new",itemsJson:v,dndEnabled:!1,renderOverrideItemDetailToggle:()=>""},D)))};var z=p(13089),P=p(1888),O=p(73529),A=p.n(O),L=function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(i=Object.getOwnPropertySymbols(e);l<i.length;l++)t.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(e,i[l])&&(a[i[l]]=e[i[l]])}return a};const H=e=>{const t=window.SVG,{className:a}=e,i=L(e,["className"]),l=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:l,src:A()},i)):s.React.createElement("svg",Object.assign({className:l},i))};var W=p(26490),B=p.n(W),E=function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(i=Object.getOwnPropertySymbols(e);l<i.length;l++)t.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(e,i[l])&&(a[i[l]]=e[i[l]])}return a};const Y=e=>{const t=window.SVG,{className:a}=e,i=E(e,["className"]),l=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:l,src:B()},i)):s.React.createElement("svg",Object.assign({className:l},i))},F="root item for tree data entry",J=e=>s.css`
    .fields-list-header {
      background: ${e.ref.palette.neutral[300]};
      border-bottom: 1px solid ${e.ref.palette.neutral[600]};
      height: 34px;
      width: 100%;
      flex-wrap: nowrap;
      .jimu-checkbox {
        margin-top: 2px;
      }
      .fields-list-check {
        margin-left: 18px;
      }
    }
    .selected-fields-con{
      margin-top: 0 !important;
      .selected-fields-list {
        flex: 1;
        max-height: 300px;
        overflow-y: auto;
      }
      .jimu-tree-item{
        background: ${e.ref.palette.neutral[300]};
        border-bottom: 1px solid ${e.ref.palette.neutral[400]};
        .jimu-tree-item__content{
          div:first-of-type{
            padding-left: 2px;
          }
          .jimu-tree-item__body{
            background: ${e.ref.palette.neutral[300]};
            .jimu-tree-item__title{
              .jimu-input{
                width: 125px;
              }
            }
            .item-remove-button {
              padding: 0 2px; /** consistent with detail icon from tree. */
            }
            &:hover {
              background: none !important;
            }
          }
        }
      }
    }
  `,Q=(e,t)=>{let a=!1;for(const i of e)if(i.jimuName===t.jimuName){a=!0;break}return a},V=e=>{const{layerConfig:t,layerDefinition:a,isEditableDs:i,onChange:n}=e,{enableEdit:o,useDataSource:d,searchFields:m,tableFields:g,layerHonorMode:p}=t,[I,b]=s.React.useState(null),v=(0,P.useTheme)(),y=s.hooks.useTranslation(u,r.defaultMessages),S=i,f=null==a?void 0:a.capabilities,j=x(f,"update")&&S,w=s.React.useMemo((()=>g.asMutable({deep:!0})),[g]),M=s.React.useMemo((()=>{let e=0;return null==w||w.forEach((t=>{(null==t?void 0:t.editAuthority)&&e++})),e}),[w]),C=s.React.useMemo((()=>w.map((e=>e.jimuName))),[w]),T=s.React.useMemo((()=>!!w&&w.some((e=>!e.editAuthority&&e.editable))),[w]),N=s.React.useMemo((()=>{if(!w)return!1;const e=w.some((e=>e.editAuthority&&e.editable)),t=w.some((e=>!e.editAuthority&&e.editable));return e&&t}),[w]),k=s.React.useCallback(((e,t)=>{const a=((null==e?void 0:e.fields)||[]).find((e=>e.name===t));return!a||(null==a?void 0:a.editable)}),[]),O=s.React.useCallback((e=>{const t=R(null==d?void 0:d.dataSourceId),i=null==t?void 0:t.getSchema(),l=(null==i?void 0:i.fields)?Object.values(null==i?void 0:i.fields):[],n=e.map((e=>({itemKey:e.jimuName,itemStateChecked:!!o&&(null==e?void 0:e.editAuthority),itemStateTitle:e.alias||e.jimuName||e.name,itemStateIcon:z.dataComponentsUtils.getIconFromFieldType(e.type,v),itemStateDetailContent:e,itemStateDisabled:!Q(l,e),itemStateCommands:[],isCheckboxDisabled:!k(a,e.jimuName)})));b({itemKey:F,itemStateTitle:F,itemChildren:n})}),[o,v,null==d?void 0:d.dataSourceId,k,a]);s.React.useEffect((()=>{w&&O(w)}),[O,w]);const A=s.React.useCallback((e=>{n(t.set("layerHonorMode",e.target.value))}),[t,n]),L=s.React.useCallback((e=>{const t=e.map((e=>e.jimuName));return m.filter((e=>t.includes(e)))}),[m]),W=s.React.useCallback((e=>{var i;if(!e)return;const l=e.filter((e=>e));let o=w;const s=l.filter((e=>!w.find((t=>t.jimuName===e.jimuName))));for(const e of s){const t=((null==a?void 0:a.fields)||[]).find((t=>t.name===e.jimuName)),i=null==t?void 0:t.editable;o.push(Object.assign(Object.assign({},e.asMutable({deep:!0})),{editAuthority:i,editable:i,visible:!0}))}const r=w.filter((e=>!l.find((t=>t.jimuName===e.jimuName)))).map((e=>e.jimuName));o=o.filter((e=>!r.includes(e.jimuName)));const c=L(o),d=e.map((e=>e.jimuName)),u=null===(i=null==t?void 0:t.useDataSource)||void 0===i?void 0:i.set("fields",d);n(t.set("searchFields",c).set("tableFields",o).set("useDataSource",u)),O(o)}),[O,L,w,t,null==a?void 0:a.fields,n]),B=s.React.useCallback((()=>{const e=w;e.forEach((e=>{e.editable&&(e.editAuthority=T)})),n(t.set("tableFields",e)),O(e)}),[O,w,T,t,n]),E=s.React.useCallback((e=>{const a=e.target.checked,i=w.map((e=>Object.assign(Object.assign({},e),{editAuthority:e.editable})));n(t.set("enableEdit",a).set("tableFields",i))}),[t,w,n]),V=s.React.useCallback((e=>{const a=w.findIndex((t=>t.jimuName===e)),i=w[a].visible;w[a].visible=!i,n(t.set("tableFields",w))}),[w,t,n]),G=s.React.useCallback(((e,t)=>{e&&"Enter"===e.key&&V(t)}),[V]),K=s.React.useCallback(((e,t)=>{const{itemJsons:a,itemJsons:[{itemStateDetailContent:i}]}=t.props,[l]=a,{jimuName:n}=(null==l?void 0:l.itemStateDetailContent)||{},o=w.find((e=>e.jimuName===n)),c=null==o?void 0:o.visible,d=y("visible"),u=y("invisible");return i?(0,s.jsx)(r.Button,{icon:!0,type:"tertiary",title:c?d:u,"aria-label":c?d:u,className:"jimu-tree-item__detail-toggle",onClick:e=>{e.stopPropagation(),V(n)},onKeyUp:e=>{G(e,n)},css:()=>s.css`
        &.jimu-tree-item__detail-toggle {
          display: flex;
          align-items: center;
          cursor: pointer;

          .icon-btn-sizer {
            margin: 0;
            min-width: 0.5rem;
            min-height: 0.5rem;
          }
        }
      `},c?(0,s.jsx)(H,null):(0,s.jsx)(Y,null)):null}),[y,V,G,w]),Z=s.React.useCallback(((e,t)=>{var a,i,l;const{draggingItemJsons:n,targetItemJsons:o,dropType:s}=e,r=null===(a=o[0])||void 0===a?void 0:a.itemChildren,c=null===(i=o[Math.min(1,o.length-2)])||void 0===i?void 0:i.itemChildren,d=null===(l=n[0])||void 0===l?void 0:l.itemChildren;let u=!0;return"to-inside"!==s||r&&!d||(u=!1),"to-inside"!==s&&c&&d&&(u=!1),u}),[]),U=s.React.useCallback(((e,a)=>{var i;const{itemJsons:l,updateType:s}=e;if(o||s===h.TreeItemActionType.HandleDidDrop){const e=l[l.length-1];b(e);const a=null===(i=e.itemChildren)||void 0===i?void 0:i.map((e=>Object.assign(Object.assign({},e.itemStateDetailContent),{editAuthority:e.itemStateChecked})));n(t.set("tableFields",a))}}),[o,t,n]);return(0,s.jsx)(c.SettingSection,{title:y("configFields"),css:J(v)},(0,s.jsx)(c.SettingRow,null,(0,s.jsx)(r.Select,{size:"sm",className:"w-100",value:p,onChange:A},(0,s.jsx)("option",{value:l.Webmap},y("layerHonorSetting")),(0,s.jsx)("option",{value:l.Custom},y("layerCustomize")))),p===l.Custom&&(0,s.jsx)(s.React.Fragment,null,(0,s.jsx)(c.SettingRow,{flow:"wrap",label:y("configTips")},(0,s.jsx)(z.FieldSelector,{useDataSources:d?(0,s.Immutable)([d]):(0,s.Immutable)([]),selectedFields:(0,s.Immutable)(C),isMultiple:!0,isDataSourceDropDownHidden:!0,useDropdown:!0,useMultiDropdownBottomTools:!0,onChange:W})),(0,s.jsx)(c.SettingRow,{flow:"wrap",label:o&&y("editableCount",{count:M})},(0,s.jsx)("div",{className:"fields-list-header form-inline"},(0,s.jsx)("div",{className:"d-flex w-100 fields-list-check"},o&&(0,s.jsx)(r.Checkbox,{id:"editAllField","data-field":"editAllField",onClick:B,checked:!T,indeterminate:N,title:T?`${y("editable")} (${y("checkAll")})`:`${y("editable")} (${y("uncheckAll")})`}),(0,s.jsx)(r.Label,{for:"editAllField",style:{cursor:"pointer"},className:"ml-2",title:y("field")},y("field"))))),(0,s.jsx)(c.SettingRow,{className:"selected-fields-con"},(0,s.jsx)(h.Tree,Object.assign({className:"selected-fields-list",rootItemJson:I,treeAlignmentType:h.TreeAlignmentType.Intact,dndEnabled:!0,isMultiSelection:o,renderOverrideItemDetailToggle:K,isItemDroppable:Z,onUpdateItem:U},D))),j&&(0,s.jsx)(c.SettingRow,null,(0,s.jsx)("div",{className:"d-flex w-100"},(0,s.jsx)(r.Checkbox,{id:"editable-cb","data-field":"enableEdit",onClick:E,checked:o}),(0,s.jsx)(r.Label,{for:"editable-cb",style:{cursor:"pointer"},className:"ml-2",title:y("enableEdit")},y("enableEdit"))))))};var G=p(41496),K=p(15562),Z=p(54337),U=p(778),_=p.n(U);const q=e=>{var t,i;const{layerConfig:l,onChange:o}=e,{columnSetting:d,headerFontSetting:m}=l,g=(0,P.useTheme2)(),p=s.hooks.useTranslation(u,r.defaultMessages,G.defaultMessages),I=s.React.useCallback(((e,t)=>{if(d)o(l.setIn(["columnSetting",e],t));else{const a={responsiveType:n.Fixed,columnWidth:200,wrapText:!1};a[e]=t,o(l.set("columnSetting",a))}}),[d,l,o]),b=s.React.useCallback(((e,t)=>{if(m)o(l.setIn(["headerFontSetting",e],t));else{const a={backgroundColor:"",fontSize:14,bold:!1,color:""};a[e]=t,o(l.set("headerFontSetting",a))}}),[m,l,o]),v=s.React.useCallback((()=>[(0,s.jsx)("option",{key:a.Start,value:a.Start},p("start")),(0,s.jsx)("option",{key:a.Center,value:a.Center},p("center")),(0,s.jsx)("option",{key:a.End,value:a.End},p("end"))]),[p]);return(0,s.jsx)(c.SettingSection,{role:"group",title:p("tableOptions"),"aria-label":p("tableOptions")},(0,s.jsx)(c.SettingRow,{flow:"no-wrap",label:p("textAlign"),className:"select-option",truncateLabel:!0},(0,s.jsx)("div",{style:{width:"40%"}},(0,s.jsx)(r.Select,{size:"sm",value:(null==d?void 0:d.textAlign)||"start",onChange:e=>{I("textAlign",e.target.value)},"aria-label":p("textAlign")},v()))),(0,s.jsx)(c.SettingRow,{tag:"label",label:p("wrapText")},(0,s.jsx)(r.Switch,{className:"can-x-switch",checked:null==d?void 0:d.wrapText,onChange:e=>{I("wrapText",e.target.checked)},"aria-label":p("wrapText")})),(0,s.jsx)(c.SettingRow,{label:(0,s.jsx)("strong",null,p("columnSize")),flow:"wrap",role:"group","aria-label":p("columnSize")},(0,s.jsx)("div",{className:"jimu-builder--background-setting"},(0,s.jsx)("div",{role:"radiogroup"},(0,s.jsx)(r.Label,{className:"d-flex align-items-center"},(0,s.jsx)(r.Radio,{style:{cursor:"pointer"},name:"responsiveType",className:"mr-2",checked:(null==d?void 0:d.responsiveType)===n.Fit,onChange:()=>{I("responsiveType",n.Fit)}}),p("fitToData")),(0,s.jsx)(r.Label,{className:"d-flex align-items-center"},(0,s.jsx)(r.Radio,{style:{cursor:"pointer"},name:"displayOrderType",className:"mr-2",checked:(null==d?void 0:d.responsiveType)===n.Fixed,onChange:()=>{I("responsiveType",n.Fixed)}}),p("fixed"))),(null==d?void 0:d.responsiveType)===n.Fixed&&(0,s.jsx)(c.SettingRow,{label:p("columnWidth")},(0,s.jsx)(K.InputUnit,{style:{width:"35%"},"aria-label":p("columnWidth"),min:80,max:8192,value:{distance:null!==(t=null==d?void 0:d.columnWidth)&&void 0!==t?t:80,unit:r.DistanceUnits.PIXEL},onChange:({distance:e})=>{I("columnWidth",e)}})))),(0,s.jsx)(c.SettingRow,{label:(0,s.jsx)("strong",null,p("variableHeader")),flow:"wrap",role:"group","aria-label":p("variableHeader")},(0,s.jsx)("div",{className:"jimu-builder--background-setting"},(0,s.jsx)(c.SettingRow,{truncateLabel:!0,flow:"no-wrap",role:"group",label:p("font"),"aria-label":p("font"),className:"mt-2"},(0,s.jsx)(K.FontStyle,{"aria-label":p("fontStyle"),bold:null==m?void 0:m.bold,types:["bold"],onChange:b}),(0,s.jsx)(Z.ThemeColorPicker,{icon:_(),type:"with-icon",title:p("fontColor"),"aria-label":p("fontColor"),specificTheme:g,value:null==m?void 0:m.color,onChange:e=>{b("color",e)},className:"jimu-outline-inside"}),(0,s.jsx)(K.InputUnit,{style:{width:"35%"},"aria-label":p("fontSize"),min:12,max:99,value:{distance:null!==(i=null==m?void 0:m.fontSize)&&void 0!==i?i:14,unit:r.DistanceUnits.PIXEL},onChange:({distance:e})=>{b("fontSize",e)}})),(0,s.jsx)(c.SettingRow,{label:p("backgroundColor")},(0,s.jsx)(Z.ThemeColorPicker,{noBackground:!0,specificTheme:g,"aria-label":p("backgroundColor"),value:null==m?void 0:m.backgroundColor,onChange:e=>{b("backgroundColor",e)}})))))};var $=p(68972);const X=e=>{const{widgetId:t,layerConfig:a,layerDefinition:n,isEditableDs:o,onChange:d}=e,{layerHonorMode:g,enableEdit:p,enableSelect:I,enableSearch:b,searchFields:v,searchExact:y,searchHint:h,selectMode:S,enableDelete:f,enableShowHideColumn:D,useDataSource:j}=a,w=s.hooks.useTranslation(u,r.defaultMessages,G.defaultMessages),M=null==n?void 0:n.capabilities,C=x(M,"delete")&&o,T=g===l.Custom?p&&C:C,R=s.React.useCallback((e=>{d(a.set("searchFields",e.map((e=>e.name))))}),[a,d]),N=s.React.useCallback((e=>{const t=e.target.value;h!==t&&d(a.set("searchHint",t))}),[h,a,d]),k=s.React.useCallback((()=>[(0,s.jsx)("option",{key:i.Single,value:i.Single},w("single")),(0,s.jsx)("option",{key:i.Multiple,value:i.Multiple},w("multiple"))]),[w]);return(0,s.jsx)(c.SettingSection,{role:"group",className:"last-setting-section",title:w("tools"),"aria-label":w("tools")},(0,s.jsx)(c.SettingRow,{tag:"label",label:w("enableSearch")},(0,s.jsx)(r.Switch,{className:"can-x-switch",checked:b||!1,onChange:e=>{const i=e.target.checked;m.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:t,propKey:"optionChangeSuggestion",value:!0}),d(a.set("enableSearch",i))},"aria-label":w("enableSearch")})),b&&(0,s.jsx)($.Fragment,null,(0,s.jsx)(c.SettingRow,{flow:"wrap",label:w("searchFields")},(0,s.jsx)("div",{className:"w-100 search-container",style:{zIndex:3}},(0,s.jsx)(z.FieldSelectorWithFullTextIndex,{useDataSources:j?(0,s.Immutable)([j]):(0,s.Immutable)([]),onChange:R,selectedFields:v?(0,s.Immutable)(v):(0,s.Immutable)([]),isMultiple:!0,isDataSourceDropDownHidden:!0,useDropdown:!0,useMultiDropdownBottomTools:!0,widgetId:t,types:(0,s.Immutable)([s.JimuFieldType.Number,s.JimuFieldType.String]),"aria-label":w("searchFields")}))),(0,s.jsx)(c.SettingRow,{className:"w-100 d-flex justify-content-between"},(0,s.jsx)(r.Label,null,(0,s.jsx)(r.Checkbox,{style:{cursor:"pointer"},checked:y,"aria-label":w("fullMatch"),onChange:(e,t)=>{d(a.set("searchExact",t))}}),(0,s.jsx)("div",{className:"m-0 ml-2 flex-grow-1 omit-label"},w("fullMatch")))),(0,s.jsx)(c.SettingRow,{flow:"wrap",label:w("searchHint")},(0,s.jsx)(r.TextInput,{size:"sm",className:"search-placeholder w-100",placeholder:w("search"),value:h||"",onChange:N,"aria-label":w("searchHint")}))),["enableSelect","showCount","enableRefresh"].map(((e,t)=>{const l=a[e]||!1;return(0,s.jsx)($.Fragment,{key:t},(0,s.jsx)(c.SettingRow,{tag:"label",label:w(e)},(0,s.jsx)(r.Switch,{className:"can-x-switch",checked:l,onChange:t=>{d(a.set(e,t.target.checked))},"aria-label":w(e)})),"enableSelect"===e&&I&&(0,s.jsx)(c.SettingRow,{flow:"wrap",label:w("selectMode"),className:"select-option"},(0,s.jsx)(r.Select,{size:"sm",value:S||i.Multiple,onChange:e=>{d(a.set("selectMode",e.target.value))},"aria-label":w("selectMode")},k())))})),T&&(0,s.jsx)(c.SettingRow,{tag:"label",label:w("deleteRecords")},(0,s.jsx)(r.Switch,{className:"can-x-switch",checked:f||!1,onChange:e=>{d(a.set("enableDelete",e.target.checked))},"aria-label":w("deleteRecords")})),(0,s.jsx)(c.SettingRow,{tag:"label",label:w("enableShowHideColumn")},(0,s.jsx)(r.Switch,{className:"can-x-switch",checked:void 0===D||D,onChange:e=>{d(a.set("enableShowHideColumn",e.target.checked))},"aria-label":w("enableShowHideColumn")})))};var ee=function(e,t,a,i){return new(a||(a=Promise))((function(l,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function s(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?l(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}r((i=i.apply(e,t||[])).next())}))};const te=e=>{const{widgetId:t,layerConfig:a,isMapMode:i,layerDefinition:l,isEditableDs:n,isNewAdd:o,handleBatchAdd:d,onConfigSaved:m,getLayerModeConfigId:g,filterDs:p,onChange:I,onClose:b}=e,[v,y]=s.React.useState(""),[h,S]=s.React.useState(null),f=s.hooks.useTranslation(u,r.defaultMessages),D=s.ReactRedux.useSelector((e=>{var t,i,l,n,o,s;const r=null===(t=null==e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig,c=null==r?void 0:r.dataSources,d=null===(i=null==a?void 0:a.useDataSource)||void 0===i?void 0:i.dataSourceId;if(!d)return!1;const u=d.indexOf("-");if(u<0)return!1;const m=d.substring(0,u),g=d.substring(u+1),p=(null===(l=null==a?void 0:a.useDataSource)||void 0===l?void 0:l.rootDataSourceId)||m,I=null===(o=null===(n=null==c?void 0:c[p])||void 0===n?void 0:n.childDataSourceJsons)||void 0===o?void 0:o[g];if(!I)return!1;return(null===(s=null==I?void 0:I.query)||void 0===s?void 0:s.refreshInterval)>0})),x=s.ReactRedux.useSelector((e=>{var a,i;const l=null===(a=null==e?void 0:e.appStateInBuilder)||void 0===a?void 0:a.appConfig,n=null===(i=null==l?void 0:l.widgets)||void 0===i?void 0:i[t];return(null==n?void 0:n.useDataSources)||(0,s.Immutable)([])})),w=s.hooks.usePrevious(D);s.React.useEffect((()=>{y((null==a?void 0:a.name)||"")}),[null==a?void 0:a.name]),s.React.useEffect((()=>{w!==D&&a&&I(a.set("updateText",D))}),[w,D,I,a]);const C=(null==a?void 0:a.useDataSource)&&(null==x?void 0:x.find((e=>{var t;return e.dataSourceId===(null===(t=null==a?void 0:a.useDataSource)||void 0===t?void 0:t.dataSourceId)})))?(0,s.Immutable)([a.useDataSource]):(0,s.Immutable)([]),T=s.React.useCallback((e=>ee(void 0,void 0,void 0,(function*(){if((null==e?void 0:e.length)>1){const t=[];for(const[a,l]of e.entries()){0===a&&S((0,s.Immutable)([e[0]]));try{const e=yield s.DataSourceManager.getInstance().createDataSourceByUseDataSource(l),a=(null==e?void 0:e.type)===s.DataSourceTypes.SceneLayer||(null==e?void 0:e.type)===s.DataSourceTypes.BuildingComponentSubLayer,n=N(e),o=M(n,i,g,a?e:void 0);t.push(o)}catch(e){console.error(e)}a===e.length-1&&S(null)}d((0,s.Immutable)(t)),m()}else{const t=null==e?void 0:e[0];if(!t)return;const l=a&&s.dataSourceUtils.areDerivedFromSameMain(t.dataSourceId,a.useDataSource.dataSourceId);try{S((0,s.Immutable)(e));const n=yield s.DataSourceManager.getInstance().createDataSourceByUseDataSource(t),o=(null==n?void 0:n.type)===s.DataSourceTypes.SceneLayer||(null==n?void 0:n.type)===s.DataSourceTypes.BuildingComponentSubLayer,r=N(n),c=l?((e,t,a,i)=>{var l,n;const o=i||e,r={dataSourceId:o.id,mainDataSourceId:null===(l=o.getMainDataSource())||void 0===l?void 0:l.id,dataViewId:o.dataViewId,rootDataSourceId:null===(n=o.getRootDataSource())||void 0===n?void 0:n.id},c=(0,s.Immutable)(r),d=t.tableFields.map((e=>e.jimuName)),u=c.set("fields",d),m=a?a(e.id):e.id;return Object.assign(Object.assign({},t.asMutable({deep:!0})),{id:m,name:e.getLabel(),useDataSource:u.asMutable({deep:!0})})})(r,a,g,o?n:void 0):M(r,i,g,o?n:void 0);I((0,s.Immutable)(c)),m()}catch(e){console.error(e)}finally{S(null)}}}))),[i,a,g,d,I,m]),R=s.React.useCallback((e=>{const t=e.target.value;y(t)}),[]),k=s.React.useCallback((e=>{(e=""===(e=null==e?void 0:e.trim())?null==a?void 0:a.name:e)!==v&&y(e),I(a.set("name",e))}),[v,a,I]);return(0,s.jsx)("div",{className:"w-100 h-100",css:s.css`
    .layer-config-panel {
      .panel-inner {
        .title {
          max-width: 70%;
        }
      }
      .setting-container {
        height: calc(100% - ${s.polished.rem(58)});
        overflow: auto;
      }
    }
  `},h&&(0,s.jsx)(r.Loading,{type:r.LoadingType.Secondary}),(0,s.jsx)("div",{className:"w-100 h-100 layer-config-panel"},(0,s.jsx)("div",{className:"w-100 d-flex px-4 py-0"},(0,s.jsx)(r.PanelHeader,{level:1,className:"px-0 py-4 panel-inner",showClose:!!b,onClose:b,title:f("layerConfig")})),(0,s.jsx)("div",{className:"setting-container"},(0,s.jsx)(c.SettingSection,{title:f("data"),className:"pt-0"},(0,s.jsx)(c.SettingRow,null,(0,s.jsx)(z.DataSourceSelector,{types:j,disableRemove:()=>!0,disableDataSourceList:i,hideDataView:i,useDataSources:h||C,mustUseDataSource:!0,onChange:T,closeDataSourceListOnChange:!0,hideDs:p,isMultiple:o,isBatched:!0})),(h||C)&&D&&(0,s.jsx)(c.SettingRow,{tag:"label",label:f("updateText")},(0,s.jsx)(r.Switch,{className:"can-x-switch",checked:void 0===(null==a?void 0:a.updateText)||a.updateText,onChange:e=>{I(a.set("updateText",e.target.checked))},"aria-label":f("updateText")}))),a&&(0,s.jsx)(s.React.Fragment,null,(0,s.jsx)(c.SettingSection,{title:f("label")},(0,s.jsx)(c.SettingRow,null,(0,s.jsx)(r.TextInput,{size:"sm",type:"text",className:"w-100",value:v,onChange:R,onAcceptValue:k,"aria-label":f("label")}))),(0,s.jsx)(V,{layerConfig:a,layerDefinition:l,isEditableDs:n,onChange:I}),(0,s.jsx)(q,{layerConfig:a,onChange:I}),(0,s.jsx)(X,{widgetId:t,layerConfig:a,layerDefinition:l,isEditableDs:n,onChange:I})))))};class ae extends s.React.PureComponent{constructor(){super(...arguments),this.onDataSourceCreated=e=>{this.props.onDataSourceCreatedOrFailed(this.props.useDataSource.dataSourceId,e)},this.onCreateDataSourceFailed=e=>{this.props.onDataSourceCreatedOrFailed(this.props.useDataSource.dataSourceId,null)}}render(){return(0,s.jsx)(s.DataSourceComponent,{useDataSource:this.props.useDataSource,onDataSourceCreated:this.onDataSourceCreated,onCreateDataSourceFailed:this.onCreateDataSourceFailed})}}var ie=function(e,t,a,i){return new(a||(a=Promise))((function(l,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function s(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?l(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}r((i=i.apply(e,t||[])).next())}))};const le="NEW_LAYER_CONFIG_ID",ne=e=>{const{widgetId:t,config:a,useDataSources:i,onSettingChange:l}=e,{layersConfig:n}=a,[o,d]=s.React.useState(null),[g,p]=s.React.useState(!1),[I,b]=s.React.useState(!1),[v,h]=s.React.useState([]),[S,f]=s.React.useState({}),D=s.hooks.useTranslation(u,r.defaultMessages)("newSheet"),{OUTPUT_DATA_VIEW_ID:x}=s.CONSTANTS,M=s.React.useRef(null),C=s.React.useRef(null),T=s.React.useMemo((()=>o===le?n.length:n.findIndex((e=>e.id===o))),[o,n]),R=s.React.useMemo((()=>{const e=n.find((e=>e.id===o));return(0,s.Immutable)(e)}),[o,n]),z=s.React.useMemo((()=>S[o]),[o,S]),P=s.React.useCallback(((e,t)=>{const a=n.findIndex((t=>t.id===e));let i;i=t?M.current.getElementsByClassName("add-edit-btn")[0]:M.current.getElementsByClassName("jimu-tree-item__body")[a],C.current=i,e!==o||t?(p(!0),d(e)):(p(!1),d(null)),b(t)}),[o,n]),O=s.React.useCallback((()=>{P(le,!0)}),[P]),A=s.React.useCallback((e=>{P(e,!1),m.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:t,propKey:"activeTabId",value:e}),m.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:t,propKey:"settingChangeTab",value:!0})}),[P,t]),L=s.React.useCallback((()=>{p(!1),d(null)}),[]),H=s.React.useCallback((e=>{const i=a.layersConfig.filter((t=>t.id!==e));let n=a.set("layersConfig",i);0===i.length&&(n=n.set("description",""));const s=i.map((e=>{var t;return null===(t=e.useDataSource)||void 0===t?void 0:t.asMutable({deep:!0})}));l({id:t,config:n,useDataSources:null==s?void 0:s.asMutable({deep:!0})}),e===o&&L()}),[o,a,L,l,t]),W=s.React.useCallback((e=>{const i=e.map((e=>n.find((t=>t.id===e))));l({id:t,config:a.set("layersConfig",i)})}),[a,n,l,t]),B=s.React.useCallback((e=>{const o=T>-1?T:n.length;let r=i||(0,s.Immutable)([]);const c=e.useDataSource;if(r=r.map((e=>c.dataSourceId===e.dataSourceId?c:e)),R)(null==R?void 0:R.id)!==e.id&&(r=r.filter((e=>{var t;return e.dataSourceId!==(null===(t=null==R?void 0:R.useDataSource)||void 0===t?void 0:t.dataSourceId)})),r=r.concat(e.useDataSource));else{const t=r.findIndex((t=>t.dataSourceId===e.useDataSource.dataSourceId));if(t>-1){const a=r[t],i=((e,t)=>{if(!e||!t)return e||t;if(e.dataSourceId&&t.dataSourceId&&e.dataSourceId!==t.dataSourceId)return null;if(!e.dataSourceId&&!t.dataSourceId)return e;if(e.fields&&t.fields){const a=Array.from(new Set(e.fields.asMutable().concat(t.fields.asMutable())));return e.merge(t.asMutable({deep:!0})).set("fields",a)}return e.merge(t.asMutable({deep:!0}))})(e.useDataSource,a),l=r.asMutable({deep:!0});r=(0,s.Immutable)(l.splice(t,1,i))}else r=r.concat(e.useDataSource)}l({id:t,config:a.setIn(["layersConfig",`${o}`],e),useDataSources:r.asMutable()}),d(e.id)}),[T,R,a,n.length,l,i,t]),E=s.React.useCallback((e=>{let o=i||(0,s.Immutable)([]);for(const t of e)o=o.concat(t.useDataSource);const r=n.concat(e);l({id:t,config:a.set("layersConfig",r),useDataSources:o.asMutable()}),d(e[0].id)}),[i,a,n,t,l]),Y=s.React.useCallback((()=>{b(!1)}),[b]),F=s.React.useCallback((e=>{const t=n.length>0?(e=>{const t=e.map((e=>e.id.split("-").reverse()[0]));return t.length>0?Math.max.apply(null,t):0})(n):0;return`${e}-${t+1}`}),[n]),J=s.React.useCallback(((e,t)=>ie(void 0,void 0,void 0,(function*(){const a=n.map((e=>e.id));if(t){const a=N(t),i=yield a.createJSAPILayerByDataSource(),l={id:e,dataSource:a,layer:i,layerDefinition:null==a?void 0:a.getLayerDefinition(),layerEditingEnabled:i.editingEnabled,isDsAutoRefresh:(null==a?void 0:a.getAutoRefreshInterval())>0,isEditableDs:(null==a?void 0:a.url)&&(null==a?void 0:a.dataViewId)!==x};f((t=>{var a;const i={};for(const o of n)(null===(a=null==o?void 0:o.useDataSource)||void 0===a?void 0:a.dataSourceId)===e?i[o.id]=l:t[o.id]&&(i[o.id]=t[o.id]);return i}))}else h((t=>[...t,e].filter((e=>a.includes(e)))))}))),[n,x]);return(0,s.jsx)(s.React.Fragment,null,n.map((e=>(0,s.jsx)(ae,{key:e.id,useDataSource:e.useDataSource,onDataSourceCreatedOrFailed:J}))),(0,s.jsx)("div",{className:"mt-4",ref:M},(0,s.jsx)(c.SettingRow,null,(0,s.jsx)(r.Button,{className:"w-100 add-edit-btn",type:"primary",onClick:O,title:D,"aria-label":D,"aria-describedby":"edit-blank-msg"},(0,s.jsx)("div",{className:"w-100 px-2 text-truncate"},(0,s.jsx)(y,{className:"mr-1 mb-1"}),D))),n.length>0&&(0,s.jsx)(k,{layersConfig:n,activeIndex:T,failedDataSourceIds:v,onRemove:H,onSort:W,onClick:A})),(0,s.jsx)(c.SidePopper,{position:"right",isOpen:g,toggle:L,trigger:null==M?void 0:M.current,backToFocusNode:C.current},(0,s.jsx)(te,{widgetId:t,layerConfig:R,isMapMode:!1,layerDefinition:null==z?void 0:z.layerDefinition,layerEditingEnabled:null==z?void 0:z.layerEditingEnabled,isDsAutoRefresh:null==z?void 0:z.isDsAutoRefresh,isEditableDs:null==z?void 0:z.isEditableDs,isNewAdd:I,handleBatchAdd:E,onConfigSaved:Y,getLayerModeConfigId:F,filterDs:e=>{let t=!1;if(w.includes(e.type)){const a=s.DataSourceManager.getInstance().getDataSource(e.id),i=(a.isDataSourceSet()?a.getAllChildDataSources():[]).filter((e=>j.includes(e.type)));0===(null==i?void 0:i.length)&&(t=!0)}return t},onChange:B,onClose:L})))};var oe=p(53195),se=p.n(oe),re=function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(i=Object.getOwnPropertySymbols(e);l<i.length;l++)t.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(e,i[l])&&(a[i[l]]=e[i[l]])}return a};const ce=e=>{const t=window.SVG,{className:a}=e,i=re(e,["className"]),l=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:l,src:se()},i)):s.React.createElement("svg",Object.assign({className:l},i))};var de=p(72529),ue=p.n(de),me=function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(i=Object.getOwnPropertySymbols(e);l<i.length;l++)t.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(e,i[l])&&(a[i[l]]=e[i[l]])}return a};const ge=e=>{const t=window.SVG,{className:a}=e,i=me(e,["className"]),l=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:l,src:ue()},i)):s.React.createElement("svg",Object.assign({className:l},i))};var pe=p(93303),Ie=p.n(pe),be=function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(i=Object.getOwnPropertySymbols(e);l<i.length;l++)t.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(e,i[l])&&(a[i[l]]=e[i[l]])}return a};const ve=e=>{const t=window.SVG,{className:a}=e,i=be(e,["className"]),l=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:l,src:Ie()},i)):s.React.createElement("svg",Object.assign({className:l},i))};var ye=p(30655),he=p.n(ye),Se=function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(i=Object.getOwnPropertySymbols(e);l<i.length;l++)t.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(e,i[l])&&(a[i[l]]=e[i[l]])}return a};const fe=e=>{const t=window.SVG,{className:a}=e,i=Se(e,["className"]),l=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:l,src:he()},i)):s.React.createElement("svg",Object.assign({className:l},i))};var De=p(94064),xe=p.n(De),je=function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(i=Object.getOwnPropertySymbols(e);l<i.length;l++)t.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(e,i[l])&&(a[i[l]]=e[i[l]])}return a};const we=e=>{const t=window.SVG,{className:a}=e,i=je(e,["className"]),l=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:l,src:xe()},i)):s.React.createElement("svg",Object.assign({className:l},i))};var Me=p(28996),Ce=p.n(Me),Te=function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(i=Object.getOwnPropertySymbols(e);l<i.length;l++)t.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(e,i[l])&&(a[i[l]]=e[i[l]])}return a};const Re=e=>{const t=window.SVG,{className:a}=e,i=Te(e,["className"]),l=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:l,src:Ce()},i)):s.React.createElement("svg",Object.assign({className:l},i))},Ne=e=>{var t;const{widgetId:a,layersConfig:i,viewGroup:l,activeMapView:n,onChange:o}=e,[d,u]=s.React.useState(""),[g,p]=s.React.useState(!1),[I,b]=s.React.useState(null),v=s.React.useRef(null),y=s.hooks.useTranslation(s.defaultMessages),{OUTPUT_DATA_VIEW_ID:S}=s.CONSTANTS,f=s.React.useMemo((()=>{const e=i.find((e=>e.id===d));return(0,s.Immutable)(e)}),[d,i]),x=s.React.useMemo((()=>{const e=R(d);return N(e)}),[d]),j=null==x?void 0:x.getLayerDefinition(),w=null===(t=null==x?void 0:x.layer)||void 0===t?void 0:t.editingEnabled,M=(null==x?void 0:x.getAutoRefreshInterval())>0,C=(null==x?void 0:x.url)&&(null==x?void 0:x.dataViewId)!==S,T=s.React.useMemo((()=>i.map((e=>({itemStateDetailContent:e,itemKey:e.id,itemStateChecked:e.id===d,itemStateTitle:e.name,itemStateCommands:[]}))).asMutable({deep:!0})),[d,i]),k=s.React.useMemo((()=>(0,s.jsx)(r.Alert,{variant:"text",form:"tooltip",size:"small",type:"error",text:y("dataSourceCreateError")})),[y]),z=s.React.useCallback(((e,t)=>{var a,i;const{itemJsons:l}=t.props,[n]=l,o=null===(i=null===(a=null==n?void 0:n.itemStateDetailContent)||void 0===a?void 0:a.useDataSource)||void 0===i?void 0:i.dataSourceId;return!!R(o)?null:k}),[k]),P=s.React.useCallback((e=>{if(u(e.id),p(!0),m.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:a,propKey:"activeTabId",value:e.id}),m.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:a,propKey:"settingChangeTab",value:!0}),v.current){const t=i.findIndex((t=>t.id===e.id)),a=v.current.getElementsByClassName("jimu-tree-item__body")[t];b(a)}}),[a,i]),O=s.React.useCallback(((e,t)=>{var a;const{itemJsons:[i]}=t.props,o=i.itemStateDetailContent;if(o.id===d)u(null),p(!1),b(null);else{(null==n?void 0:n.dataSourceId)===(null===(a=o.useDataSource)||void 0===a?void 0:a.rootDataSourceId)?P(o):l&&l.switchMap().then((()=>{P(o)}))}}),[d,n,P,l]),A=()=>{u(null),p(!1)};return(0,s.jsx)(c.SettingRow,null,(0,s.jsx)("div",{className:"w-100",ref:v},(0,s.jsx)(h.List,Object.assign({className:"py-1",itemsJson:T,dndEnabled:!0,onUpdateItem:(e,t)=>{if("handleDidDrop"===e.updateType){const{dragItemIndex:t,targetDropItemIndex:a}=e,l=e=>"number"==typeof e&&e>-1&&e<i.length;if(l(t)&&l(a)){const e=i.asMutable({deep:!0}),l=e.splice(t,1)[0];e.splice(a,0,l),o((0,s.Immutable)(e))}}},renderOverrideItemDetailToggle:z,onClickItemBody:O},D))),(0,s.jsx)(c.SidePopper,{position:"right",isOpen:g,toggle:A,trigger:v.current,backToFocusNode:I},(0,s.jsx)(te,{widgetId:a,layerConfig:f,isMapMode:!0,layerDefinition:j,layerEditingEnabled:w,isDsAutoRefresh:M,isEditableDs:C,onChange:e=>{const t=i.findIndex((e=>e.id===d));o(s.Immutable.set(i,t,e),d)},onClose:A})))};var ke=function(e,t,a,i){return new(a||(a=Promise))((function(l,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function s(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?l(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}r((i=i.apply(e,t||[])).next())}))};const ze=()=>s.css`
  .map-layers-setting-row {
    width: calc(100% - 22px);
    max-width: calc(100% - 22px);

    .jimu-widget-setting--row-label {
      width: 100%;
      flex-basis: 100%;
      flex-shrink: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .map-title-icon-container {
      flex-wrap: no-wrap;
      flex-shrink: 0;
      flex-grow: 0;
      justify-content: flex-end;
      min-width: 20px;

      .setting-loading-container {
        position: relative;
        height: 16px;
        width: 16px;

        .donut-loading {
          width: 16px !important;
          height: 16px !important;
          left: 0 !important;
          right: 0 !important;
          top: 0 !important;
          bottom: 0 !important;
        }
      }
    }
  }
`,Pe=e=>{var t;const{widgetId:a,jimuMapView:i,viewGroup:n,activeMapView:o,mapViewConfig:d=(0,s.Immutable)({}),useDataSources:m=(0,s.Immutable)([]),onChange:g}=e,p=(null==d?void 0:d.customizeLayers)||!1,I=(null==d?void 0:d.customJimuLayerViewIds)||(0,s.Immutable)([]),b=(null==d?void 0:d.layersConfig)||(0,s.Immutable)([]),v=void 0===(null==d?void 0:d.displayRuntimeLayers)||d.displayRuntimeLayers,[y,h]=s.React.useState(!1),[S,f]=s.React.useState(!1),[D,x]=s.React.useState([]),[j,w]=s.React.useState([]),[C,N]=s.React.useState(!1),k=s.React.useRef(null),z=s.hooks.useTranslation(r.defaultMessages,u),P="3d"===(null===(t=i.view)||void 0===t?void 0:t.type),O=s.React.useMemo((()=>R(i.dataSourceId)),[i.dataSourceId]),A=s.React.useMemo((()=>{var e;return(null===(e=null==O?void 0:O.getLabel)||void 0===e?void 0:e.call(O))||""}),[O]),L=I.asMutable({deep:!0}),H=s.React.useMemo((()=>{const e=[];return D.forEach((t=>{const a="imagery"===t.type,i=null==t?void 0:t.getLayerDataSource(),l=null==i?void 0:i.getSchema();a&&!(null==l?void 0:l.fields)||e.push(t.id);t.getAllAncestorJimuLayerViews().forEach((t=>{const a="imagery"===t.type,i=null==t?void 0:t.getLayerDataSource(),l=null==i?void 0:i.getSchema();a&&!(null==l?void 0:l.fields)||e.push(t.id)}))})),j.forEach((t=>ke(void 0,void 0,void 0,(function*(){const a=i.getDataSourceIdByAPILayer(t),l=s.DataSourceManager.getInstance().getDataSource(a),n=i.getMapDataSource();let o=l;if(!l&&n)try{o=yield n.createDataSourceByLayer(t)}catch(e){console.log(e)}o&&e.push(t.id)})))),e}),[D,j,i]);s.React.useEffect((()=>{!function(){ke(this,void 0,void 0,(function*(){yield i.whenJimuMapViewLoaded();const e=yield i.whenAllJimuLayerViewLoaded(),t=i.getJimuTables().filter((e=>{var t;return null===(t=e.table)||void 0===t?void 0:t.visible}));let a=Object.values(e).filter((e=>!e.fromRuntime&&T(e)));const l=a.map((e=>e.createLayerDataSource()));try{yield Promise.all(l)}catch(e){console.log(e)}var n;i.isActive||(yield(n=500,new Promise((e=>{setTimeout((()=>{e()}),n)})))),a=a.filter((e=>!!e.getLayerDataSource()));const o=t.map((e=>e.table));x(a),w(o),h(!0)}))}()}),[i]);const W=s.React.useCallback((()=>{f(!0)}),[]),B=s.React.useCallback((()=>{N((e=>!e))}),[]),E=s.React.useCallback((()=>{f(!1)}),[]),Y=(e,t)=>{var a;return e?Object.assign({dataSourceId:e.id,mainDataSourceId:e.getMainDataSource().id,dataViewId:e.dataViewId,rootDataSourceId:null===(a=e.getRootDataSource())||void 0===a?void 0:a.id},t?{useFieldsInPopupInfo:!0}:{}):null},F=s.React.useCallback(((e,t)=>ke(void 0,void 0,void 0,(function*(){let e=m.asMutable({deep:!0});const a=i.getAllJimuLayerViews().filter((e=>T(e))).filter((e=>null==e?void 0:e.isLayerVisible())),l=i.getJimuTables().filter((e=>{var t;return null===(t=e.table)||void 0===t?void 0:t.visible}));if(t){const t=a.map((e=>e.id)),n=l.map((e=>e.jimuTableId)),o=t.concat(n),r=[];for(const t of a){if(null==t?void 0:t.fromRuntime)continue;let a;try{a=yield t.getOrCreateLayerDataSource()}catch(e){continue}if(!a)continue;const i=M(a,!0),l="imagery"===t.type,n=null==a?void 0:a.getSchema();if(l&&!(null==n?void 0:n.fields))continue;r.push(i);const o=Y(a,!0);e=Oe(e,"add",o)}for(const t of l){const a=t.table,l=i.getDataSourceIdByAPILayer(a),n=s.DataSourceManager.getInstance().getDataSource(l),o=i.getMapDataSource();let c=n;if(!n&&o)try{c=yield o.createDataSourceByLayer(a)}catch(e){continue}if(!c)continue;const d=M(c,!0);r.push(d);const u=Y(c,!0);e=Oe(e,"add",u)}g(i.id,d.set("customizeLayers",!0).set("customJimuLayerViewIds",o).set("layersConfig",r),e)}else{for(const t of a){let a;try{a=yield t.getOrCreateLayerDataSource()}catch(e){continue}if(!a)continue;const i="imagery"===t.type,l=null==a?void 0:a.getSchema();if(i&&!(null==l?void 0:l.fields))continue;const n=Y(a,!0);e=Oe(e,"remove",n)}for(const t of l){const a=t.table,l=i.getDataSourceIdByAPILayer(a),n=s.DataSourceManager.getInstance().getDataSource(l),o=i.getMapDataSource();let r=n;if(!n&&o)try{r=yield o.createDataSourceByLayer(a)}catch(e){continue}if(!r)continue;const c=Y(r,!0);e=Oe(e,"remove",c)}e&&0===e.length&&(e=void 0),g(i.id,d.set("customizeLayers",!1).set("customJimuLayerViewIds",[]).set("displayRuntimeLayers",!0).set("layersConfig",[]),e)}}))),[m,i,d,g]),J=s.React.useCallback(((e,t)=>{const a=m.asMutable({deep:!0});g(i.id,d.set("displayRuntimeLayers",t),a)}),[i.id,d,m,g]),Q=s.React.useCallback((e=>!H.includes(e.id)),[H]),V=s.React.useCallback((e=>!D.includes(e)),[D]),G=s.React.useCallback((e=>ke(void 0,void 0,void 0,(function*(){var t;const a=i.jimuLayerViews,l=i.jimuTables,n=e.map((e=>{var t;return(null===(t=null==a?void 0:a[e])||void 0===t?void 0:t.layerDataSourceId)||i.getDataSourceIdByAPILayer(null==l?void 0:l[e])}));let o=b.filter((e=>n.includes(e.id)));const r=e.filter((e=>{var t;const n=(null===(t=null==a?void 0:a[e])||void 0===t?void 0:t.layerDataSourceId)||i.getDataSourceIdByAPILayer(null==l?void 0:l[e]);return n&&!b.find((e=>e.id===n))})),c=[];for(const e of r){const t=null==a?void 0:a[e],n=null==l?void 0:l[e];let o;if(t)try{o=yield t.getOrCreateLayerDataSource()}catch(e){console.log(e)}else if(n){const e=i.getDataSourceIdByAPILayer(n),t=s.DataSourceManager.getInstance().getDataSource(e),a=i.getMapDataSource();if(o=t,!t&&a)try{o=yield a.createDataSourceByLayer(n)}catch(e){console.log(e)}}o&&c.push(M(o,!0))}o=o.concat(c);const u=null===(t=null==d?void 0:d.customJimuLayerViewIds)||void 0===t?void 0:t.asMutable({deep:!0}),{add:p,remove:I,diff:v}=((e,t)=>{const a=[],i=[];return e.forEach((e=>{t.includes(e)||i.push(e)})),t.forEach((t=>{e.includes(t)||a.push(t)})),{add:a,remove:i,diff:a.concat(i)}})(u,e);let y=m.asMutable({deep:!0});for(const e of v){const t=a[e],n=l[e];let o;if(t)o=t.getLayerDataSource();else if(n){const e=i.getDataSourceIdByAPILayer(n),t=s.DataSourceManager.getInstance().getDataSource(e),a=i.getMapDataSource();o=t,!t&&a&&(o=yield a.createDataSourceByLayer(n))}const r=Y(o,!0);p.includes(e)?y=Oe(y,"add",r):I.includes(e)&&(y=Oe(y,"remove",r))}g(i.id,d.set("customJimuLayerViewIds",e).set("layersConfig",o),y)}))),[i,m,b,d,g]),K=s.React.useCallback(((e,t)=>{let a=m.asMutable({deep:!0});const n=e.find((e=>e.id===t));if(n){const e=a.findIndex((e=>{var t;return e.dataSourceId===(null===(t=n.useDataSource)||void 0===t?void 0:t.dataSourceId)}));if(n.layerHonorMode===l.Custom){const t=n.tableFields.map((e=>e.jimuName));a[e].fields=t,a[e].useFieldsInPopupInfo=!1}else a[e].fields=[],a[e].useFieldsInPopupInfo=!0}a=Oe(a,"update"),g(i.id,d.set("layersConfig",e),a)}),[m,i.id,d,g]);return(0,s.jsx)(s.React.Fragment,null,(0,s.jsx)("div",{className:"map-layers-header w-100 d-flex align-items-center mt-4",css:ze},P?(0,s.jsx)(ge,{className:"mr-2"}):(0,s.jsx)(ce,{className:"mr-2"}),(0,s.jsx)(c.SettingRow,{flow:"no-wrap",className:"map-layers-setting-row w-100",label:A,"aria-label":A},(0,s.jsx)("div",{className:"map-title-icon-container d-flex align-items-center"},!y&&(0,s.jsx)("div",{className:"setting-loading-container"},(0,s.jsx)(r.Loading,{type:r.LoadingType.Donut})),y&&0===D.length&&0===j.length&&(0,s.jsx)(r.Tooltip,{title:z("noAvailableLayers"),showArrow:!1,placement:"top"},(0,s.jsx)("span",null,(0,s.jsx)(r.Button,{className:"border-0",disabled:!y,type:"tertiary",icon:!0,size:"sm"},(0,s.jsx)(Re,{size:16,color:"var(--sys-color-warning-main)"})))),y&&(D.length>0||j.length>0)&&(0,s.jsx)(s.React.Fragment,null,(0,s.jsx)(r.Tooltip,{title:z("selectLayers"),showArrow:!1,placement:"top"},(0,s.jsx)("span",null,(0,s.jsx)(r.Button,{ref:k,className:"map-layers-setting-btn mr-1 p-0 border-0",disabled:!y,type:"tertiary",icon:!0,size:"sm",onClick:W},(0,s.jsx)(ve,{size:16})))),p&&b.length>0&&(0,s.jsx)(r.Button,{className:"layer-list-toggle-btn p-0 border-0",type:"tertiary",icon:!0,size:"sm",onClick:B},C?(0,s.jsx)(we,{size:16}):(0,s.jsx)(fe,{size:16})))))),C&&b.length>0&&(0,s.jsx)(Ne,{widgetId:a,layersConfig:b,viewGroup:n,activeMapView:o,onChange:K}),S&&(0,s.jsx)(c.SidePopper,{isOpen:!0,toggle:E,position:"right",trigger:k.current,title:z("selectLayers")},(0,s.jsx)(c.SettingRow,{tag:"label",className:"w-100 pl-4 pr-4",label:z("customizeLayers")},(0,s.jsx)(r.Switch,{className:"can-x-switch",checked:p,"data-key":"customizeLayers",onChange:F,"aria-label":z("customizeLayers")})),(0,s.jsx)(c.SettingRow,{tag:"label",className:"w-100 pl-4 pr-4",label:z("displayRuntimeLayers")},(0,s.jsx)(r.Switch,{className:"can-x-switch",checked:v,"data-key":"displayRuntimeLayers",onChange:J,"aria-label":z("displayRuntimeLayers"),disabled:!p})),p&&(0,s.jsx)(s.React.Fragment,null,(0,s.jsx)(c.SettingRow,{className:"w-100 pl-4 pr-4",label:A,"aria-label":A}),(0,s.jsx)("div",{className:"select-jimu-layer-view-selector-container p-4"},(0,s.jsx)(c.JimuLayerViewSelector,{jimuMapViewId:i.id,isMultiSelection:!0,selectedValues:L,isShowTables:!0,hideLayers:Q,disableLayers:V,onChange:G})))))};const Oe=(e,t,a)=>{let i=e||[];"remove"===t?i=i.filter((e=>e.dataSourceId!==a.dataSourceId)):"add"===t&&a&&!i.find((e=>e.dataSourceId===a.dataSourceId))?i=i.concat([a]):"update"===t&&(i=e);const l="remove"===t?[]:void 0;return i.length>0?i:l},Ae=e=>{const{widgetId:t,config:a,useMapWidgetIds:i,mapEmpty:l,jimuMapViews:n,viewGroup:o,activeMapView:d,useDataSources:u,onSettingChange:m}=e,{mapViewsConfig:g}=a,p=(null==i?void 0:i.length)>0,I=s.hooks.useTranslation(r.defaultMessages),b=s.React.useCallback(((e,i,l)=>{m({id:t,config:a.setIn(["mapViewsConfig",e],i),useDataSources:l})}),[a,m,t]);return(0,s.jsx)(s.React.Fragment,null,(0,s.jsx)(c.SettingRow,null,(0,s.jsx)(c.MapWidgetSelector,{useMapWidgetIds:i,onSelect:e=>{const i=a.set("mapViewsConfig",{});m({id:t,config:i,useMapWidgetIds:e})}})),p&&!l&&n.map((e=>(0,s.jsx)(Pe,{widgetId:t,key:e.id,jimuMapView:e,viewGroup:o,activeMapView:d,mapViewConfig:null==g?void 0:g[e.id],useDataSources:u,onChange:b}))),p&&l&&(0,s.jsx)(c.SettingRow,null,(0,s.jsx)(r.Alert,{tabIndex:0,type:"warning",className:"warningMsg",open:!0,text:I("noWebMapWebSceneTip")})))},Le=e=>s.css`
  &.arrange-style-container {
    .arrange_container {
      margin-top: 10px;
      display: flex;
      .jimu-btn {
        padding: 0;
        background: ${e.ref.palette.neutral[300]};
        &.active {
          border: 2px solid ${e.sys.color.primary.light};
        }
      }
      .icon-size {
        width: 109px;
        height: 70px;
      }
    }
  }
`,He=e=>{const{config:a,onPropertyChange:i}=e,{arrangeType:l}=a,n=(0,P.useTheme)(),o=s.hooks.useTranslation(u,r.defaultMessages);return(0,s.jsx)(c.SettingSection,{role:"group",className:"arrange-style-container",title:o("sheetStyle"),"aria-label":o("sheetStyle"),css:Le(n)},(0,s.jsx)(c.SettingRow,{className:"arrange_container"},(0,s.jsx)(r.Tooltip,{title:o("tabs"),placement:"bottom"},(0,s.jsx)(r.Button,{onClick:()=>{i("arrangeType",t.Tabs)},icon:!0,size:"sm",type:"tertiary",active:l===t.Tabs,"aria-pressed":l===t.Tabs},(0,s.jsx)(r.Icon,{autoFlip:!0,className:"icon-size",icon:p(79226)}))),(0,s.jsx)(r.Tooltip,{title:o("dropdown"),placement:"bottom"},(0,s.jsx)(r.Button,{onClick:()=>{i("arrangeType",t.Dropdown)},className:"ml-2",icon:!0,size:"sm",type:"tertiary",active:l===t.Dropdown,"aria-pressed":l===t.Dropdown},(0,s.jsx)(r.Icon,{autoFlip:!0,className:"icon-size",icon:p(8377)})))))};var We=p(31027),Be=p.n(We),Ee=function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(i=Object.getOwnPropertySymbols(e);l<i.length;l++)t.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(e,i[l])&&(a[i[l]]=e[i[l]])}return a};const Ye=e=>{const t=window.SVG,{className:a}=e,i=Ee(e,["className"]),l=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:l,src:Be()},i)):s.React.createElement("svg",Object.assign({className:l},i))},Fe=e=>s.css`
    &.empty-placeholder {
      display: flex;
      flex-flow: column;
      justify-content: center;
      height: calc(100% - 255px);
      overflow: hidden;
      .empty-placeholder-inner {
        padding: 0px 20px;
        flex-direction: column;
        align-items: center;
        display: flex;
        .empty-placeholder-text {
          color: ${e.ref.palette.neutral[1e3]};
          font-size: 14px;
          margin-top: 16px;
          text-align: center;
        }
        .empty-placeholder-icon {
          color: ${e.ref.palette.neutral[800]};
        }
      }
    }
  `,Je=e=>{const{isMapMode:t}=e,a=s.hooks.useTranslation(u,r.defaultMessages),i=(0,P.useTheme)(),l=a("newSheet"),n=t?a("noMapSelectedTips"):a("tableBlankStatus",{SheetString:l});return(0,s.jsx)("div",{className:"empty-placeholder w-100",css:Fe(i)},(0,s.jsx)("div",{className:"empty-placeholder-inner"},(0,s.jsx)("div",{className:"empty-placeholder-icon"},(0,s.jsx)(Ye,{size:48})),(0,s.jsx)("div",{className:"empty-placeholder-text",id:"edit-blank-msg"},n)))},Qe=e=>{const{config:t,onPropertyChange:a}=e,{enableMapExtentFilter:i,defaultExtentFilterEnabled:l,enableRelatedRecords:n,enableAttachments:o}=t,d=s.hooks.useTranslation(u,r.defaultMessages);return(0,s.jsx)(c.SettingSection,{role:"group",title:d("options"),"aria-label":d("options")},(0,s.jsx)(c.SettingRow,{tag:"label",label:d("enableMapExtentFilter")},(0,s.jsx)(r.Switch,{className:"can-x-switch",checked:i,"data-key":"enableMapExtentFilter",onChange:e=>{a("enableMapExtentFilter",e.target.checked)},"aria-label":d("enableMapExtentFilter")})),i&&(0,s.jsx)(c.SettingRow,null,(0,s.jsx)(r.Label,{className:"d-flex align-items-center ml-2"},(0,s.jsx)(r.Checkbox,{checked:l,className:"mr-1",onChange:e=>{a("defaultExtentFilterEnabled",e.target.checked)}}),d("defaultEnabled"))),(0,s.jsx)(c.SettingRow,{tag:"label",label:d("enableRelatedRecords")},(0,s.jsx)(r.Switch,{className:"can-x-switch",checked:n,"data-key":"enableRelatedRecords",onChange:e=>{a("enableRelatedRecords",e.target.checked)},"aria-label":d("enableRelatedRecords")})),(0,s.jsx)(c.SettingRow,{tag:"label",label:d("enableAttachments")},(0,s.jsx)(r.Switch,{className:"can-x-switch",checked:o,"data-key":"enableAttachments",onChange:e=>{a("enableAttachments",e.target.checked)},"aria-label":d("enableAttachments")})))},Ve=e=>{const{config:t,onPropertyChange:a}=e,{enableAttachments:i}=t,l=s.hooks.useTranslation(u,r.defaultMessages);return(0,s.jsx)(c.SettingSection,{role:"group",title:l("tools"),"aria-label":l("tools")},(0,s.jsx)(c.SettingRow,{tag:"label",label:l("enableAttachments")},(0,s.jsx)(r.Switch,{className:"can-x-switch",checked:i,"data-key":"enableAttachments",onChange:e=>{a("enableAttachments",e.target.checked)},"aria-label":l("enableAttachments")})))};var Ge=function(e,t,a,i){return new(a||(a=Promise))((function(l,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function s(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?l(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}r((i=i.apply(e,t||[])).next())}))};const Ke=t=>{const{id:a,config:i,useDataSources:l,useMapWidgetIds:n,onSettingChange:o}=t,{tableMode:m,layersConfig:g=(0,s.Immutable)([]),mapViewsConfig:p=(0,s.Immutable)({})}=i,[I,b]=s.React.useState(!1),[v,y]=s.React.useState(!1),[h,S]=s.React.useState([]),[f,D]=s.React.useState(),[x,j]=s.React.useState(),w=s.React.useRef(null),M=window.isExpressBuilder,C=m===e.Map,T=(null==n?void 0:n.length)>0,R=!C&&g.length>0||C&&p&&Object.keys(p).length>0,N=s.hooks.useTranslation(u,r.defaultMessages),k=s.React.useCallback(((e,t)=>{if(t===i[e])return;const l=i.set(e,t);o({id:a,config:l})}),[i,o,a]),z=s.React.useCallback((()=>{o({id:a,config:i.set("tableMode",w.current).set("layersConfig",[]).set("mapViewsConfig",{}).set("enableMapExtentFilter",w.current===e.Map).set("defaultExtentFilterEnabled",!1).set("enableHighlightOnHover",!1),useDataSources:w.current===e.Map?void 0:[]}),w.current=null,b(!1)}),[i,o,a]),P=s.React.useCallback((e=>{m!==e&&(w.current=e,R?b(!0):z())}),[m,z,R]),O=s.React.useCallback((e=>{S([]);const t=Object.values(e);1!==Object.keys(t).length||Object.values(t)[0].dataSourceId?y(!1):y(!0);const a=Object.values(e).map((e=>Ge(void 0,void 0,void 0,(function*(){yield e.whenJimuMapViewLoaded(),yield e.whenAllJimuLayerViewLoaded()}))));Promise.allSettled(a).then((()=>{S(t)}))}),[y]);return(0,s.jsx)("div",{className:"h-100"},(0,s.jsx)("div",{className:"jimu-widget-setting widget-setting-table h-100"},(0,s.jsx)(c.SettingSection,{role:"group",title:N("mode")},(0,s.jsx)("div",{role:"radiogroup",className:"mb-4"},(0,s.jsx)(r.Label,{className:"d-flex align-items-center"},(0,s.jsx)(r.Radio,{style:{cursor:"pointer"},name:"editModeType",className:"mr-2",checked:!C,onChange:()=>{P(e.Layer)}}),N("selectLayers")),(0,s.jsx)(r.Label,{className:"d-flex align-items-center"},(0,s.jsx)(r.Radio,{style:{cursor:"pointer"},name:"editModeType",className:"mr-2",checked:C,onChange:()=>{P(e.Map)}}),N("interactWithMap"))),!C&&(0,s.jsx)(ne,{widgetId:a,config:i,useDataSources:l,onSettingChange:o}),C&&(0,s.jsx)(Ae,{widgetId:a,config:i,useMapWidgetIds:n,mapEmpty:v,jimuMapViews:h,viewGroup:f,activeMapView:x,useDataSources:l,onSettingChange:o})),C&&T&&!v&&(0,s.jsx)(Qe,{config:i,onPropertyChange:k}),!C&&R&&(0,s.jsx)(Ve,{config:i,onPropertyChange:k}),(0,s.jsx)(He,{config:i,onPropertyChange:k}),!C&&!R&&!M&&(0,s.jsx)(Je,{isMapMode:!1}),C&&!T&&!M&&(0,s.jsx)(Je,{isMapMode:!0}),C&&(0,s.jsx)(d.JimuMapViewComponent,{useMapWidgetId:null==n?void 0:n[0],onViewsCreate:O,onViewGroupCreate:e=>{D(e)},onActiveViewChange:e=>{j(e)}}),I&&(0,s.jsx)(r.ConfirmDialog,{level:"warning",title:N("changeModeConfirmTitle"),hasNotShowAgainOption:!1,content:N("changeModeConfirmTips"),onConfirm:z,onClose:()=>{b(!1)}})))};function Ze(e){p.p=e}})(),I})())}}}));