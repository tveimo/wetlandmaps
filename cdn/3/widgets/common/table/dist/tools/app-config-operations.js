System.register(["jimu-core","jimu-arcgis"],(function(e,t){var i={},o={};return{setters:[function(e){i.Immutable=e.Immutable,i.dataSourceUtils=e.dataSourceUtils},function(e){o.mapViewUtils=e.mapViewUtils}],execute:function(){e((()=>{var e={62686:e=>{"use strict";e.exports=o},79244:e=>{"use strict";e.exports=i}},t={};function a(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,a),r.exports}a.d=(e,t)=>{for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="";var r={};return a.p=window.jimuConfig.baseUrl,(()=>{"use strict";a.r(r),a.d(r,{default:()=>o});var e=a(79244),t=a(62686);const i=(0,e.Immutable)([]);class o{constructor(){this.id="table-app-config-operation"}afterWidgetCopied(o,a,r,s,n){var u,c;if(!n)return s;let l=s;const d=a.widgets[o],m=null!==(u=d.useDataSources)&&void 0!==u?u:i,f=null==d?void 0:d.config;if(f.mapViewsConfig){let i=(0,e.Immutable)({});for(const[o,a]of Object.entries(f.mapViewsConfig)){const r=(a.customJimuLayerViewIds||(0,e.Immutable)([])).map((e=>t.mapViewUtils.getCopiedJimuLayerViewId(n,e))),s=a.set("customJimuLayerViewIds",r),u=t.mapViewUtils.getCopiedJimuMapViewId(n,o);i=i.set(u,s)}l=l.setIn(["widgets",r,"config","mapViewsConfig"],i)}const g=m.filter((e=>!!n[e.mainDataSourceId]));if(!g||0===(null==g?void 0:g.length))return l;const p=l.widgets[o],v=null==p?void 0:p.useDataSources,S=e.dataSourceUtils.mapUseDataSources(n,v);S.isChanged&&(l=l.setIn(["widgets",r,"config","useDataSources"],S.useDataSources));const w=null===(c=null==p?void 0:p.config)||void 0===c?void 0:c.layersConfig;return null==w||w.forEach(((t,i)=>{var o;const a=null==t?void 0:t.useDataSource,s=e.dataSourceUtils.mapUseDataSources(n,(0,e.Immutable)([a]));if(s.isChanged){const e=(null===(o=s.useDataSources)||void 0===o?void 0:o[0])||a,n=t.id.replace(a.dataSourceId,e.dataSourceId);l=l.setIn(["widgets",r,"config","layersConfig",i,"useDataSource"],e),l=l.setIn(["widgets",r,"config","layersConfig",i,"id"],n)}})),l}}})(),r})())}}}));